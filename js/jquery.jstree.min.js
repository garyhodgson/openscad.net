/*
 * jsTree 1.0-rc3
 * http://jstree.com/
 *
 * Copyright (c) 2010 Ivan Bozhanov (vakata.com)
 *
 * Licensed same as jquery - under the terms of either the MIT License or the GPL Version 2 License
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * $Date: 2011-02-09 01:17:14 +0200 (ср, 09 февр 2011) $
 * $Revision: 236 $
 */
(function(){if(!jQuery||!jQuery.jstree){var J=!1,S=!1,W=!1,g=jQuery;g.vakata={};g.vakata.css={get_css:function(a,b,c){var a=a.toLowerCase(),d=c.cssRules||c.rules,k=0;do{if(d.length&&k>d.length+5)break;if(d[k].selectorText&&d[k].selectorText.toLowerCase()==a)return!0===b?(c.removeRule&&c.removeRule(k),c.deleteRule&&c.deleteRule(k),!0):d[k]}while(d[++k]);return!1},add_css:function(a,b){if(g.jstree.css.get_css(a,!1,b))return!1;b.insertRule?b.insertRule(a+" { }",0):b.addRule(a,null,0);return g.vakata.css.get_css(a)},
remove_css:function(a,b){return g.vakata.css.get_css(a,!0,b)},add_sheet:function(a){var b=!1,c=!0;if(a.str)return a.title&&(b=g("style[id='"+a.title+"-stylesheet']")[0]),b?c=!1:(b=document.createElement("style"),b.setAttribute("type","text/css"),a.title&&b.setAttribute("id",a.title+"-stylesheet")),b.styleSheet?c?(document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet.cssText=a.str):b.styleSheet.cssText=b.styleSheet.cssText+" "+a.str:(b.appendChild(document.createTextNode(a.str)),document.getElementsByTagName("head")[0].appendChild(b)),
b.sheet||b.styleSheet;if(a.url)if(document.createStyleSheet)try{document.createStyleSheet(a.url)}catch(d){}else return b=document.createElement("link"),b.rel="stylesheet",b.type="text/css",b.media="all",b.href=a.url,document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet}};var s=[],K=-1,R={},z={};g.fn.jstree=function(a){var b="string"==typeof a,c=Array.prototype.slice.call(arguments,1),d=this;if(b){if("_"==a.substring(0,1))return d;this.each(function(){var b=s[g.data(this,"jstree_instance_id")],
b=b&&g.isFunction(b[a])?b[a].apply(b,c):b;if("undefined"!==typeof b&&(0===a.indexOf("is_")||!0!==b&&!1!==b))return d=b,!1})}else this.each(function(){var b=g.data(this,"jstree_instance_id"),d=[],j=a?g.extend({},!0,a):{},i=g(this),e=!1,X=[],d=d.concat(c);i.data("jstree")&&d.push(i.data("jstree"));j=d.length?g.extend.apply(null,[!0,j].concat(d)):j;"undefined"!==typeof b&&s[b]&&s[b].destroy();b=parseInt(s.push({}),10)-1;g.data(this,"jstree_instance_id",b);j.plugins=g.isArray(j.plugins)?j.plugins:g.jstree.defaults.plugins.slice();
j.plugins.unshift("core");j.plugins=j.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");e=g.extend(!0,{},g.jstree.defaults,j);e.plugins=j.plugins;g.each(R,function(a){-1===g.inArray(a,e.plugins)?(e[a]=null,delete e[a]):X.push(a)});e.plugins=X;s[b]=new g.jstree._instance(b,g(this).addClass("jstree jstree-"+b),e);g.each(s[b]._get_settings().plugins,function(a,c){s[b].data[c]={}});g.each(s[b]._get_settings().plugins,function(a,c){R[c]&&
R[c].__init.apply(s[b])});setTimeout(function(){s[b]&&s[b].init()},0)});return d};g.jstree={defaults:{plugins:[]},_focused:function(){return s[K]||null},_reference:function(a){if(s[a])return s[a];var b=g(a);!b.length&&"string"===typeof a&&(b=g("#"+a));return!b.length?null:s[b.closest(".jstree").data("jstree_instance_id")]||null},_instance:function(a,b,c){this.data={core:{}};this.get_settings=function(){return g.extend(!0,{},c)};this._get_settings=function(){return c};this.get_index=function(){return a};
this.get_container=function(){return b};this.get_container_ul=function(){return b.children("ul:eq(0)")};this._set_settings=function(a){c=g.extend(!0,{},c,a)}},_fn:{},plugin:function(a,b){b=g.extend({},{__init:g.noop,__destroy:g.noop,_fn:{},defaults:!1},b);R[a]=b;g.jstree.defaults[a]=b.defaults;g.each(b._fn,function(b,d){d.plugin=a;d.old=g.jstree._fn[b];g.jstree._fn[b]=function(){var a,f=d,j=Array.prototype.slice.call(arguments);a=new g.Event("before.jstree");var i=!1;if(!(!0===this.data.core.locked&&
"unlock"!==b&&"is_locked"!==b)){do{if(f&&f.plugin&&-1!==g.inArray(f.plugin,this._get_settings().plugins))break;f=f.old}while(f);if(f){if(0===b.indexOf("_"))a=f.apply(this,j);else{a=this.get_container().triggerHandler(a,{func:b,inst:this,args:j,plugin:f.plugin});if(!1===a)return;"undefined"!==typeof a&&(j=a);a=f.apply(g.extend({},this,{__callback:function(a){this.get_container().triggerHandler(b+".jstree",{inst:this,args:j,rslt:a,rlbk:i})},__rollback:function(){return i=this.get_rollback()},__call_old:function(a){return f.old.apply(this,
a?Array.prototype.slice.call(arguments,1):j)}}),j)}return a}}};g.jstree._fn[b].old=d.old;g.jstree._fn[b].plugin=a})},rollback:function(a){a&&(g.isArray(a)||(a=[a]),g.each(a,function(a,c){s[c.i].set_rollback(c.h,c.d)}))}};g.jstree._fn=g.jstree._instance.prototype={};g(function(){var a=navigator.userAgent.toLowerCase(),b=(a.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],c=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";
if(/msie/.test(a)&&6==parseInt(b,10)){J=!0;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(d){}c+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}/msie/.test(a)&&
7==parseInt(b,10)&&(S=!0,c+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } ");!/compatible/.test(a)&&(/mozilla/.test(a)&&1.9>parseFloat(b,10))&&(W=!0,c+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } ");g.vakata.css.add_sheet({str:c,title:"jstree"})});g.jstree.plugin("core",{__init:function(){this.data.core.locked=!1;this.data.core.to_open=
this.get_settings().core.initially_open;this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:!1,animation:500,initially_open:[],initially_load:[],open_parents:!0,notify_plugins:!0,rtl:!1,load_open:!1,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus();this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl");this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+
this._get_string("loading")+"</a></li></ul>");this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",g.proxy(function(a){a=g(a.target);this.toggle_node(a)},this)).bind("mousedown.jstree",g.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(){var a;if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){a=window.getSelection();
try{a.removeAllRanges(),a.collapse()}catch(b){}}});this._get_settings().core.notify_plugins&&this.get_container().bind("load_node.jstree",g.proxy(function(a,b){var c=this._get_node(b.rslt.obj),d=this;-1===c&&(c=this.get_container_ul());c.length&&c.find("li").each(function(){var a=g(this);a.data("jstree")&&g.each(a.data("jstree"),function(b,c){d.data[b]&&g.isFunction(d["_"+b+"_notify"])&&d["_"+b+"_notify"].call(d,a,c)})})},this));this._get_settings().core.load_open&&this.get_container().bind("load_node.jstree",
g.proxy(function(a,b){var c=this._get_node(b.rslt.obj),d=this;-1===c&&(c=this.get_container_ul());c.length&&c.find("li.jstree-open:not(:has(ul))").each(function(){d.load_node(this,g.noop,g.noop)})},this));this.__callback();this.load_node(-1,function(){this.loaded();this.reload_nodes()})},destroy:function(){var a,b=this.get_index(),c=this._get_settings(),d=this;g.each(c.plugins,function(a,b){try{R[b].__destroy.apply(d)}catch(c){}});this.__callback();if(this.is_focused())for(a in s)if(s.hasOwnProperty(a)&&
a!=b){s[a].set_focus();break}b===K&&(K=-1);this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});g(document).unbind(".jstree-"+b).undelegate(".jstree-"+b);s[b]=null;delete s[b]},_core_notify:function(a,b){b.opened&&this.open_node(a,!1,!0)},lock:function(){this.data.core.locked=!0;this.get_container().children("ul").addClass("jstree-locked").css("opacity",
"0.7");this.__callback({})},unlock:function(){this.data.core.locked=!1;this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1");this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var a=this;this.data.core.to_open=[];this.get_container_ul().find("li.jstree-open").each(function(){this.id&&a.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,
"\\.").replace(/\:/g,"\\:"))});this.__callback(a.data.core.to_open)},save_loaded:function(){},reload_nodes:function(a){var b=this,c=!0,d=[],k=[];a||(this.data.core.reopen=!1,this.data.core.refreshing=!0,this.data.core.to_open=g.map(g.makeArray(this.data.core.to_open),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_load=g.map(g.makeArray(this.data.core.to_load),function(a){return"#"+
a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_open.length&&(this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open)));this.data.core.to_load.length&&(g.each(this.data.core.to_load,function(a,b){if("#"==b)return!0;g(b).length?d.push(b):k.push(b)}),d.length&&(this.data.core.to_load=k,g.each(d,function(a,d){b._is_loaded(d)||(b.load_node(d,function(){b.reload_nodes(!0)},function(){b.reload_nodes(!0)}),
c=!1)})));this.data.core.to_open.length&&g.each(this.data.core.to_open,function(a,c){b.open_node(c,!1,!0)});c&&(this.data.core.reopen&&clearTimeout(this.data.core.reopen),this.data.core.reopen=setTimeout(function(){b.__callback({},b)},50),this.data.core.refreshing=!1,this.reopen())},reopen:function(){var a=this;this.data.core.to_open.length&&g.each(this.data.core.to_open,function(b,c){a.open_node(c,!1,!0)});this.__callback({})},refresh:function(a){var b=this;this.save_opened();a||(a=-1);(a=this._get_node(a))||
(a=-1);-1!==a?a.children("UL").remove():this.get_container_ul().empty();this.load_node(a,function(){b.__callback({obj:a});b.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(!this.is_focused()){var a=g.jstree._focused();a&&a.unset_focus();this.get_container().addClass("jstree-focused");K=this.get_index();this.__callback()}},is_focused:function(){return K==this.get_index()},unset_focus:function(){this.is_focused()&&(this.get_container().removeClass("jstree-focused"),K=
-1);this.__callback()},_get_node:function(a){var b=g(a,this.get_container());if(b.is(".jstree")||-1==a)return-1;b=b.closest("li",this.get_container());return b.length?b:!1},_get_next:function(a,b){a=this._get_node(a);return-1===a?this.get_container().find("> ul > li:first-child"):!a.length?!1:b?0<a.nextAll("li").size()?a.nextAll("li:eq(0)"):!1:a.hasClass("jstree-open")?a.find("li:eq(0)"):0<a.nextAll("li").size()?a.nextAll("li:eq(0)"):a.parentsUntil(".jstree","li").next("li").eq(0)},_get_prev:function(a,
b){a=this._get_node(a);if(-1===a)return this.get_container().find("> ul > li:last-child");if(!a.length)return!1;if(b)return 0<a.prevAll("li").length?a.prevAll("li:eq(0)"):!1;if(a.prev("li").length){for(a=a.prev("li").eq(0);a.hasClass("jstree-open");)a=a.children("ul:eq(0)").children("li:last");return a}var c=a.parentsUntil(".jstree","li:eq(0)");return c.length?c:!1},_get_parent:function(a){a=this._get_node(a);if(-1==a||!a.length)return!1;a=a.parentsUntil(".jstree","li:eq(0)");return a.length?a:-1},
_get_children:function(a){a=this._get_node(a);return-1===a?this.get_container().children("ul:eq(0)").children("li"):!a.length?!1:a.children("ul:eq(0)").children("li")},get_path:function(a,b){var c=[],d=this,a=this._get_node(a);if(-1===a||!a||!a.length)return!1;a.parentsUntil(".jstree","li").each(function(){c.push(b?this.id:d.get_text(this))});c.reverse();c.push(b?a.attr("id"):this.get_text(a));return c},_get_string:function(a){return this._get_settings().core.strings[a]||a},is_open:function(a){return(a=
this._get_node(a))&&-1!==a&&a.hasClass("jstree-open")},is_closed:function(a){return(a=this._get_node(a))&&-1!==a&&a.hasClass("jstree-closed")},is_leaf:function(a){return(a=this._get_node(a))&&-1!==a&&a.hasClass("jstree-leaf")},correct_state:function(a){a=this._get_node(a);if(!a||-1===a)return!1;a.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:a})},open_node:function(a,b,c){a=this._get_node(a);if(!a.length)return!1;if(!a.hasClass("jstree-closed"))return b&&
b.call(),!1;var d=c||J?0:this._get_settings().core.animation,k=this;this._is_loaded(a)?(this._get_settings().core.open_parents&&a.parentsUntil(".jstree",".jstree-closed").each(function(){k.open_node(this,!1,!0)}),d&&a.children("ul").css("display","none"),a.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),d?a.children("ul").stop(!0,!0).slideDown(d,function(){this.style.display="";k.after_open(a)}):k.after_open(a),this.__callback({obj:a}),b&&b.call()):
(a.children("a").addClass("jstree-loading"),this.load_node(a,function(){k.open_node(a,b,c)},b))},after_open:function(a){this.__callback({obj:a})},close_node:function(a,b){var a=this._get_node(a),c=b||J?0:this._get_settings().core.animation,d=this;if(!a.length||!a.hasClass("jstree-open"))return!1;c&&a.children("ul").attr("style","display:block !important");a.removeClass("jstree-open").addClass("jstree-closed");c?a.children("ul").stop(!0,!0).slideUp(c,function(){this.style.display="";d.after_close(a)}):
d.after_close(a);this.__callback({obj:a})},after_close:function(a){this.__callback({obj:a})},toggle_node:function(a){a=this._get_node(a);if(a.hasClass("jstree-closed"))return this.open_node(a);if(a.hasClass("jstree-open"))return this.close_node(a)},open_all:function(a,b,c){a=a?this._get_node(a):-1;if(!a||-1===a)a=this.get_container_ul();c?a=a.find("li.jstree-closed"):(c=a,a=a.is(".jstree-closed")?a.find("li.jstree-closed").andSelf():a.find("li.jstree-closed"));var d=this;a.each(function(){var a=this;
d._is_loaded(this)?d.open_node(this,!1,!b):d.open_node(this,function(){d.open_all(a,b,c)},!b)});0===c.find("li.jstree-closed").length&&this.__callback({obj:c})},close_all:function(a,b){var c=this,a=a?this._get_node(a):this.get_container();if(!a||-1===a)a=this.get_container_ul();a.find("li.jstree-open").andSelf().each(function(){c.close_node(this,!b)});this.__callback({obj:a})},clean_node:function(a){a=a&&-1!=a?g(a):this.get_container_ul();a=a.is("li")?a.find("li").andSelf():a.find("li");a.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");
a.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:a})},get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(a,b){this.get_container().empty().append(a);this.data=b;this.__callback()},load_node:function(a){this.__callback({obj:a})},_is_loaded:function(){return!0},create_node:function(a,b,c,d,k){var a=this._get_node(a),b="undefined"===typeof b?"last":
b,f=g("<li />"),j=this._get_settings().core,i;if(-1!==a&&!a.length)return!1;if(!k&&!this._is_loaded(a))return this.load_node(a,function(){this.create_node(a,b,c,d,!0)}),!1;this.__rollback();"string"===typeof c&&(c={data:c});c||(c={});c.attr&&f.attr(c.attr);c.metadata&&f.data(c.metadata);c.state&&f.addClass("jstree-"+c.state);c.data||(c.data=this._get_string("new_node"));g.isArray(c.data)||(i=c.data,c.data=[],c.data.push(i));g.each(c.data,function(a,b){i=g("<a />");g.isFunction(b)&&(b=b.call(this,
c));if("string"==typeof b)i.attr("href","#")[j.html_titles?"html":"text"](b);else b.attr||(b.attr={}),b.attr.href||(b.attr.href="#"),i.attr(b.attr)[j.html_titles?"html":"text"](b.title),b.language&&i.addClass(b.language);i.prepend("<ins class='jstree-icon'>&#160;</ins>");!b.icon&&c.icon&&(b.icon=c.icon);b.icon&&(-1===b.icon.indexOf("/")?i.children("ins").addClass(b.icon):i.children("ins").css("background","url('"+b.icon+"') center center no-repeat"));f.append(i)});f.prepend("<ins class='jstree-icon'>&#160;</ins>");
-1===a&&(a=this.get_container(),"before"===b&&(b="first"),"after"===b&&(b="last"));switch(b){case "before":a.before(f);i=this._get_parent(a);break;case "after":a.after(f);i=this._get_parent(a);break;case "inside":case "first":a.children("ul").length||a.append("<ul />");a.children("ul").prepend(f);i=a;break;case "last":a.children("ul").length||a.append("<ul />");a.children("ul").append(f);i=a;break;default:a.children("ul").length||a.append("<ul />"),b||(b=0),i=a.children("ul").children("li").eq(b),
i.length?i.before(f):a.children("ul").append(f),i=a}if(-1===i||i.get(0)===this.get_container().get(0))i=-1;this.clean_node(i);this.__callback({obj:f,parent:i});d&&d.call(this,f);return f},get_text:function(a){a=this._get_node(a);if(!a.length)return!1;var b=this._get_settings().core.html_titles,a=a.children("a:eq(0)");if(b)return a=a.clone(),a.children("INS").remove(),a.html();a=a.contents().filter(function(){return 3==this.nodeType})[0];return a.nodeValue},set_text:function(a,b){a=this._get_node(a);
if(!a.length)return!1;a=a.children("a:eq(0)");if(this._get_settings().core.html_titles){var c=a.children("INS").clone();a.html(b).prepend(c);this.__callback({obj:a,name:b});return!0}a=a.contents().filter(function(){return 3==this.nodeType})[0];this.__callback({obj:a,name:b});return a.nodeValue=b},rename_node:function(a,b){a=this._get_node(a);this.__rollback();a&&(a.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments)))&&this.__callback({obj:a,name:b})},delete_node:function(a){a=
this._get_node(a);if(!a.length)return!1;this.__rollback();var b=this._get_parent(a),c=g([]),d=this;a.each(function(){c=c.add(d._get_prev(this))});a=a.detach();-1!==b&&0===b.find("> ul > li").length&&b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf");this.clean_node(b);this.__callback({obj:a,prev:c,parent:b});return a},prepare_move:function(a,b,c,d,k){var f={};f.ot=g.jstree._reference(a)||this;f.o=f.ot._get_node(a);f.r=-1===b?-1:this._get_node(b);f.p="undefined"===typeof c||!1===c?
"last":c;if(k||!z.o||!(z.o[0]===f.o[0]&&z.r[0]===f.r[0]&&z.p===f.p)){f.ot=g.jstree._reference(f.o)||this;f.rt=g.jstree._reference(f.r)||this;if(-1===f.r||!f.r)switch(f.cr=-1,f.p){case "first":case "before":case "inside":f.cp=0;break;case "after":case "last":f.cp=f.rt.get_container().find(" > ul > li").length;break;default:f.cp=f.p}else{if(!/^(before|after)$/.test(f.p)&&!this._is_loaded(f.r))return this.load_node(f.r,function(){this.prepare_move(a,b,c,d,!0)});switch(f.p){case "before":f.cp=f.r.index();
f.cr=f.rt._get_parent(f.r);break;case "after":f.cp=f.r.index()+1;f.cr=f.rt._get_parent(f.r);break;case "inside":case "first":f.cp=0;f.cr=f.r;break;case "last":f.cp=f.r.find(" > ul > li").length;f.cr=f.r;break;default:f.cp=f.p,f.cr=f.r}}f.np=-1==f.cr?f.rt.get_container():f.cr;f.op=f.ot._get_parent(f.o);f.cop=f.o.index();-1===f.op&&(f.op=f.ot?f.ot.get_container():this.get_container());!/^(before|after)$/.test(f.p)&&(f.op&&f.np&&f.op[0]===f.np[0]&&f.o.index()<f.cp)&&f.cp++;f.or=f.np.find(" > ul > li:nth-child("+
(f.cp+1)+")");z=f}this.__callback(z);d&&d.call(this,z)},check_move:function(){var a=z,b=!0,c=-1===a.r?this.get_container():a.r;if(!a||(!a.o||a.or[0]===a.o[0])||a.op&&a.np&&a.op[0]===a.np[0]&&a.cp-1===a.o.index())return!1;a.o.each(function(){if(-1!==c.parentsUntil(".jstree","li").andSelf().index(this))return b=!1});return b},move_node:function(a,b,c,d,k,f){if(!k)return this.prepare_move(a,b,c,function(a){this.move_node(a,!1,!1,d,!0,f)});d&&(z.cy=!0);if(!f&&!this.check_move())return!1;this.__rollback();
b=!1;d?(b=a.o.clone(!0),b.find("*[id]").andSelf().each(function(){this.id&&(this.id="copy_"+this.id)})):b=a.o;a.or.length?a.or.before(b):(a.np.children("ul").length||g("<ul />").appendTo(a.np),a.np.children("ul:eq(0)").append(b));try{a.ot.clean_node(a.op),a.rt.clean_node(a.np),a.op.find("> ul > li").length||a.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(j){}d&&(z.cy=!0,z.oc=b);this.__callback(z);return z},_get_move:function(){return z}}});var q=
jQuery,T,L,U;q(function(){/msie/.test(navigator.userAgent.toLowerCase())?(L=q('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1E3,left:0}).appendTo("body"),U=q('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1E3,left:0}).appendTo("body"),T=L.width()-U.width(),L.add(U).remove()):(L=q("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1E3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",
height:200}),T=100-L.width(),L.parent().remove())});q.jstree.plugin("ui",{__init:function(){this.data.ui.selected=q();this.data.ui.last_selected=!1;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",q.proxy(function(a){a.preventDefault();a.currentTarget.blur();q(a.currentTarget).hasClass("jstree-loading")||this.select_node(a.currentTarget,!0,a)},this)).delegate("a","mouseenter.jstree",q.proxy(function(a){q(a.currentTarget).hasClass("jstree-loading")||
this.hover_node(a.target)},this)).delegate("a","mouseleave.jstree",q.proxy(function(a){q(a.currentTarget).hasClass("jstree-loading")||this.dehover_node(a.target)},this)).bind("reopen.jstree",q.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",q.proxy(function(){this.dehover_node();this.save_selected()},this)).bind("set_rollback.jstree",q.proxy(function(){this.reselect()},this)).bind("close_node.jstree",q.proxy(function(a,b){var c=this._get_settings().ui,d=this._get_node(b.rslt.obj),
k=d&&d.length?d.children("ul").find("a.jstree-clicked"):q(),f=this;!1!==c.selected_parent_close&&k.length&&k.each(function(){f.deselect_node(this);"select_parent"===c.selected_parent_close&&f.select_node(d)})},this)).bind("delete_node.jstree",q.proxy(function(a,b){var c=this._get_settings().ui.select_prev_on_delete,d=this._get_node(b.rslt.obj),d=d&&d.length?d.find("a.jstree-clicked"):[],k=this;d.each(function(){k.deselect_node(this)});c&&d.length&&b.rslt.prev.each(function(){if(this.parentNode)return k.select_node(this),
!1})},this)).bind("move_node.jstree",q.proxy(function(a,b){b.rslt.cy&&b.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:!0,select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(a,b){if("undefined"===typeof a||null===a)return b?this.data.ui.selected:this.data.ui.last_selected;var c=q(a,
this.get_container());if(c.is(".jstree")||-1==a)return-1;c=c.closest("li",this.get_container());return c.length?c:!1},_ui_notify:function(a,b){b.selected&&this.select_node(a,!1)},save_selected:function(){var a=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){this.id&&a.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))});this.__callback(this.data.ui.to_select)},
reselect:function(){var a=this,b=this.data.ui.to_select,b=q.map(q.makeArray(b),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});q.each(b,function(b,d){d&&"#"!==d&&a.select_node(d)});this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode});this.__callback()},refresh:function(){this.save_selected();return this.__call_old()},hover_node:function(a){a=this._get_node(a);
if(!a.length)return!1;a.hasClass("jstree-hovered")||this.dehover_node();this.data.ui.hovered=a.children("a").addClass("jstree-hovered").parent();this._fix_scroll(a);this.__callback({obj:a})},dehover_node:function(){var a=this.data.ui.hovered,b;if(!a||!a.length)return!1;b=a.children("a").removeClass("jstree-hovered").parent();this.data.ui.hovered[0]===b[0]&&(this.data.ui.hovered=null);this.__callback({obj:a})},select_node:function(a,b,c){a=this._get_node(a);if(-1==a||!a||!a.length)return!1;var d=this._get_settings().ui,
k="on"==d.select_multiple_modifier||!1!==d.select_multiple_modifier&&c&&c[d.select_multiple_modifier+"Key"],f=!1!==d.select_range_modifier&&c&&c[d.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==a[0]&&this.data.ui.last_selected.parent()[0]===a.parent()[0],j=this.is_selected(a),i=!0,e=this;if(b){if(d.disable_selecting_children&&k&&(a.parentsUntil(".jstree","li").children("a.jstree-clicked").length||a.children("ul").find("a.jstree-clicked:eq(0)").length))return!1;
i=!1;switch(!0){case f:this.data.ui.last_selected.addClass("jstree-last-selected");a=a[a.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf();-1==d.select_limit||a.length<d.select_limit?(this.data.ui.last_selected.removeClass("jstree-last-selected"),this.data.ui.selected.each(function(){this!==e.data.ui.last_selected[0]&&e.deselect_node(this)}),j=!1,i=!0):i=!1;break;case j&&!k:this.deselect_all();j=!1;i=!0;break;case !j&&!k:if(-1==d.select_limit||
0<d.select_limit)this.deselect_all(),i=!0;break;case j&&k:this.deselect_node(a);break;case !j&&k:if(-1==d.select_limit||this.data.ui.selected.length+1<=d.select_limit)i=!0}}i&&!j&&(f||(this.data.ui.last_selected=a),a.children("a").addClass("jstree-clicked"),d.selected_parent_open&&a.parents(".jstree-closed").each(function(){e.open_node(this,!1,!0)}),this.data.ui.selected=this.data.ui.selected.add(a),this._fix_scroll(a.eq(0)),this.__callback({obj:a,e:c}))},_fix_scroll:function(a){var b=this.get_container()[0];
if(b.scrollHeight>b.offsetHeight&&(a=this._get_node(a))&&!(-1===a||!a.length||!a.is(":visible")))if(a=a.offset().top-this.get_container().offset().top,0>a&&(b.scrollTop=b.scrollTop+a-1),a+this.data.core.li_height+(b.scrollWidth>b.offsetWidth?T:0)>b.offsetHeight)b.scrollTop+=a-b.offsetHeight+this.data.core.li_height+1+(b.scrollWidth>b.offsetWidth?T:0)},deselect_node:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)&&(a.children("a").removeClass("jstree-clicked"),this.data.ui.selected=
this.data.ui.selected.not(a),this.data.ui.last_selected.get(0)===a.get(0)&&(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:a}))},toggle_select:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)?this.deselect_node(a):this.select_node(a)},is_selected:function(a){return 0<=this.data.ui.selected.index(this._get_node(a))},get_selected:function(a){return a?q(a).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(a){a=a?q(a).find("a.jstree-clicked").parent():
this.get_container().find("a.jstree-clicked").parent();a.children("a.jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=q([]);this.data.ui.last_selected=!1;this.__callback({obj:a})}}});q.jstree.defaults.plugins.push("ui");var M=jQuery;M.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",M.proxy(function(a,b){if(this._get_settings().crrm.move.open_onmove){var c=this;b.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){c.open_node(this,
!1,!0)})}},this))},defaults:{input_width_limit:200,move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(){return!0}}},_fn:{_show_input:function(a,b){var a=this._get_node(a),c=this._get_settings().core.rtl,d=this._get_settings().crrm.input_width_limit,k=a.children("ins").width(),f=a.find("> a:visible > ins").width()*a.find("> a:visible > ins").length,j=this.get_text(a),i=M("<div />",{css:{position:"absolute",top:"-200px",left:c?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),
e=a.css("position","relative").append(M("<input />",{value:j,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:c?"auto":k+f+4+"px",right:c?k+f+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:M.proxy(function(){var c=a.children(".jstree-rename-input"),d=c.val();""===d&&(d=j);i.remove();c.remove();this.set_text(a,j);this.rename_node(a,d);b.call(this,a,d,j);a.css("position","")},
this),keyup:function(a){a=a.keyCode||a.which;27==a?(this.value=j,this.blur()):13==a?this.blur():e.width(Math.min(i.text("pW"+this.value).width(),d))},keypress:function(a){if(13==(a.keyCode||a.which))return!1}})).children(".jstree-rename-input");this.set_text(a,"");i.css({fontFamily:e.css("fontFamily")||"",fontSize:e.css("fontSize")||"",fontWeight:e.css("fontWeight")||"",fontStyle:e.css("fontStyle")||"",fontStretch:e.css("fontStretch")||"",fontVariant:e.css("fontVariant")||"",letterSpacing:e.css("letterSpacing")||
"",wordSpacing:e.css("wordSpacing")||""});e.width(Math.min(i.text("pW"+e[0].value).width(),d))[0].select()},rename:function(a){a=this._get_node(a);this.__rollback();var b=this.__callback;this._show_input(a,function(a,d,k){b.call(this,{obj:a,new_name:d,old_name:k})})},create:function(a,b,c,d,k){var f=this;(a=this._get_node(a))||(a=-1);this.__rollback();return this.create_node(a,b,c,function(a){var b=this._get_parent(a),c=M(a).index();d&&d.call(this,a);b.length&&b.hasClass("jstree-closed")&&this.open_node(b,
!1,!0);k?f.__callback({obj:a,name:this.get_text(a),parent:b,position:c}):this._show_input(a,function(a,d){f.__callback({obj:a,name:d,parent:b,position:c})})})},remove:function(a){var a=this._get_node(a,!0),b=this._get_parent(a),c=this._get_prev(a);this.__rollback();a=this.delete_node(a);!1!==a&&this.__callback({obj:a,prev:c,parent:b})},check_move:function(){return!this.__call_old()||!this._get_settings().crrm.move.check_move.call(this,this._get_move())?!1:!0},move_node:function(a,b,c,d,k,f){var j=
this._get_settings().crrm.move;if(!k)return"undefined"===typeof c&&(c=j.default_position),"inside"===c&&!j.default_position.match(/^(before|after)$/)&&(c=j.default_position),this.__call_old(!0,a,b,c,d,!1,f);if(!0===j.always_copy||"multitree"===j.always_copy&&a.rt.get_index()!==a.ot.get_index())d=!0;this.__call_old(!0,a,b,c,d,!0,f)},cut:function(a){a=this._get_node(a,!0);if(!a||!a.length)return!1;this.data.crrm.cp_nodes=!1;this.data.crrm.ct_nodes=a;this.__callback({obj:a})},copy:function(a){a=this._get_node(a,
!0);if(!a||!a.length)return!1;this.data.crrm.ct_nodes=!1;this.data.crrm.cp_nodes=a;this.__callback({obj:a})},paste:function(a){a=this._get_node(a);if(!a||!a.length)return!1;var b=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes)return!1;this.data.crrm.ct_nodes&&(this.move_node(this.data.crrm.ct_nodes,a),this.data.crrm.ct_nodes=!1);this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,a,!1,!0);this.__callback({obj:a,
nodes:b})}}});var A=jQuery,Y=[];A.jstree._themes=!1;A.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",A.proxy(function(){var a=this._get_settings().themes;this.data.themes.dots=a.dots;this.data.themes.icons=a.icons;this.set_theme(a.theme,a.url)},this)).bind("loaded.jstree",A.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,icons:!0},
_fn:{set_theme:function(a,b){if(!a)return!1;b||(b=A.jstree._themes+a+"/style.css");-1==A.inArray(b,Y)&&(A.vakata.css.add_sheet({url:b}),Y.push(b));this.data.themes.theme!=a&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=a);this.get_container().addClass("jstree-"+a);this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons();this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=
!0;this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=!1;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1;this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?
this.hide_icons():this.show_icons()}}});A(function(){!1===A.jstree._themes&&A("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/))return A.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1});!1===A.jstree._themes&&(A.jstree._themes="themes/")});A.jstree.defaults.plugins.push("themes");var G=jQuery,Z=[];G.jstree.plugin("hotkeys",{__init:function(){if("undefined"===typeof G.hotkeys)throw"jsTree hotkeys: jQuery hotkeys plugin not included.";
if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";G.each(this._get_settings().hotkeys,function(a,b){!1!==b&&-1==G.inArray(a,Z)&&(G(document).bind("keydown",a,function(b){a:{var d=G.jstree._focused(),k;if(d&&(d.data&&d.data.hotkeys&&d.data.hotkeys.enabled)&&(k=d._get_settings().hotkeys[a])){b=k.call(d,b);break a}b=void 0}return b}),Z.push(a))});this.get_container().bind("lock.jstree",G.proxy(function(){this.data.hotkeys.enabled&&(this.data.hotkeys.enabled=!1,this.data.hotkeys.revert=
!0)},this)).bind("unlock.jstree",G.proxy(function(){this.data.hotkeys.revert&&(this.data.hotkeys.enabled=!0)},this));this.enable_hotkeys()},defaults:{up:function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"ctrl+up":function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"shift+up":function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},down:function(){this.hover_node(this._get_next(this.data.ui.hovered||
this.data.ui.last_selected||-1));return!1},"ctrl+down":function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"shift+down":function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},left:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a)));return!1},"ctrl+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;
a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a)));return!1},"shift+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a)));return!1},right:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a)));return!1},"ctrl+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;
a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a)));return!1},"shift+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a)));return!1},space:function(){this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click();return!1},"ctrl+space":function(a){a.type="click";this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a);
return!1},"shift+space":function(a){a.type="click";this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a);return!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=!1}}});var n=jQuery;n.jstree.plugin("json_data",{__init:function(){this._get_settings().json_data.progressive_unload&&
this.get_container().bind("after_close.jstree",function(a,b){b.rslt.obj.children("ul").remove()})},defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1,progressive_unload:!1},_fn:{load_node:function(a,b,c){var d=this;this.load_node_json(a,function(){d.__callback({obj:d._get_node(a)});b.call(this)},c)},_is_loaded:function(a){var b=this._get_settings().json_data,a=this._get_node(a);return-1==a||!a||!b.ajax&&!b.progressive_render&&!n.isFunction(b.data)||a.is(".jstree-open, .jstree-leaf")||
0<a.children("ul").children("li").length},refresh:function(a){var a=this._get_node(a),b=this._get_settings().json_data;a&&(-1!==a&&b.progressive_unload&&(n.isFunction(b.data)||b.ajax))&&a.removeData("jstree_children");return this.__call_old()},load_node_json:function(a,b,c){var d=this.get_settings().json_data,k,f=function(){};k=function(){};if((a=this._get_node(a))&&-1!==a&&(d.progressive_render||d.progressive_unload)&&!a.is(".jstree-open, .jstree-leaf")&&0===a.children("ul").children("li").length&&
a.data("jstree_children")){if(k=this._parse_json(a.data("jstree_children"),a))a.append(k),d.progressive_unload||a.removeData("jstree_children");this.clean_node(a);b&&b.call(this)}else{if(a&&-1!==a){if(a.data("jstree_is_loading"))return;a.data("jstree_is_loading",!0)}switch(!0){case !d.data&&!d.ajax:throw"Neither data nor ajax settings supplied.";case n.isFunction(d.data):d.data.call(this,a,n.proxy(function(f){(f=this._parse_json(f,a))?(-1===a||!a?this.get_container().children("ul").empty().append(f.children()):
(a.append(f).children("a.jstree-loading").removeClass("jstree-loading"),a.removeData("jstree_is_loading")),this.clean_node(a),b&&b.call(this)):(-1===a||!a?d.correct_state&&this.get_container().children("ul").empty():(a.children("a.jstree-loading").removeClass("jstree-loading"),a.removeData("jstree_is_loading"),d.correct_state&&this.correct_state(a)),c&&c.call(this))},this));break;case !!d.data&&!d.ajax||!!d.data&&!!d.ajax&&(!a||-1===a):if(!a||-1==a)(k=this._parse_json(d.data,a))?(this.get_container().children("ul").empty().append(k.children()),
this.clean_node()):d.correct_state&&this.get_container().children("ul").empty();b&&b.call(this);break;case !d.data&&!!d.ajax||!!d.data&&!!d.ajax&&a&&-1!==a:f=function(b,f,k){var e=this.get_settings().json_data.ajax.error;e&&e.call(this,b,f,k);-1!=a&&a.length?(a.children("a.jstree-loading").removeClass("jstree-loading"),a.removeData("jstree_is_loading"),"success"===f&&d.correct_state&&this.correct_state(a)):"success"===f&&d.correct_state&&this.get_container().children("ul").empty();c&&c.call(this)},
k=function(c,k,e){var g=this.get_settings().json_data.ajax.success;g&&(c=g.call(this,c,k,e)||c);if(""===c||c&&c.toString&&""===c.toString().replace(/^[\s\n]+$/,"")||!n.isArray(c)&&!n.isPlainObject(c))return f.call(this,e,k,"");(c=this._parse_json(c,a))?(-1===a||!a?this.get_container().children("ul").empty().append(c.children()):(a.append(c).children("a.jstree-loading").removeClass("jstree-loading"),a.removeData("jstree_is_loading")),this.clean_node(a),b&&b.call(this)):-1===a||!a?d.correct_state&&
(this.get_container().children("ul").empty(),b&&b.call(this)):(a.children("a.jstree-loading").removeClass("jstree-loading"),a.removeData("jstree_is_loading"),d.correct_state&&(this.correct_state(a),b&&b.call(this)))},d.ajax.context=this,d.ajax.error=f,d.ajax.success=k,d.ajax.dataType||(d.ajax.dataType="json"),n.isFunction(d.ajax.url)&&(d.ajax.url=d.ajax.url.call(this,a)),n.isFunction(d.ajax.data)&&(d.ajax.data=d.ajax.data.call(this,a)),n.ajax(d.ajax)}}},_parse_json:function(a,b,c){var d=!1,k=this._get_settings(),
f=k.json_data,e=k.core.html_titles,i;if(!a)return d;f.progressive_unload&&(b&&-1!==b)&&b.data("jstree_children",d);if(n.isArray(a)){d=n();if(!a.length)return!1;k=0;for(f=a.length;k<f;k++)i=this._parse_json(a[k],b,!0),i.length&&(d=d.add(i))}else{"string"==typeof a&&(a={data:a});if(!a.data&&""!==a.data)return d;d=n("<li />");a.attr&&d.attr(a.attr);a.metadata&&d.data(a.metadata);a.state&&d.addClass("jstree-"+a.state);n.isArray(a.data)||(i=a.data,a.data=[],a.data.push(i));n.each(a.data,function(b,c){i=
n("<a />");n.isFunction(c)&&(c=c.call(this,a));if("string"==typeof c)i.attr("href","#")[e?"html":"text"](c);else c.attr||(c.attr={}),c.attr.href||(c.attr.href="#"),i.attr(c.attr)[e?"html":"text"](c.title),c.language&&i.addClass(c.language);i.prepend("<ins class='jstree-icon'>&#160;</ins>");!c.icon&&a.icon&&(c.icon=a.icon);c.icon&&(-1===c.icon.indexOf("/")?i.children("ins").addClass(c.icon):i.children("ins").css("background","url('"+c.icon+"') center center no-repeat"));d.append(i)});d.prepend("<ins class='jstree-icon'>&#160;</ins>");
a.children&&(f.progressive_render&&"open"!==a.state?d.addClass("jstree-closed").data("jstree_children",a.children):(f.progressive_unload&&d.data("jstree_children",a.children),n.isArray(a.children)&&a.children.length&&(i=this._parse_json(a.children,b,!0),i.length&&(b=n("<ul />"),b.append(i),d.append(b)))))}c||(c=n("<ul />"),c.append(d),d=c);return d},get_json:function(a,b,c,d){var k=[],f=this._get_settings(),e=this,i,g,h,m,l,p,a=this._get_node(a);if(!a||-1===a)a=this.get_container().find("> ul > li");
b=n.isArray(b)?b:["id","class"];!d&&this.data.types&&b.push(f.types.type_attr);c=n.isArray(c)?c:[];a.each(function(){h=n(this);i={data:[]};b.length&&(i.attr={});n.each(b,function(a,b){(g=h.attr(b))&&(g.length&&g.replace(/jstree[^ ]*/ig,"").length)&&(i.attr[b]=(" "+g).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))});h.hasClass("jstree-open")&&(i.state="open");h.hasClass("jstree-closed")&&(i.state="closed");h.data()&&(i.metadata=h.data());m=h.children("a");m.each(function(){l=
n(this);c.length||-1!==n.inArray("languages",f.plugins)||l.children("ins").get(0).style.backgroundImage.length||l.children("ins").get(0).className&&l.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length?(p=!1,-1!==n.inArray("languages",f.plugins)&&(n.isArray(f.languages)&&f.languages.length)&&n.each(f.languages,function(a,b){if(l.hasClass(b))return p=b,!1}),g={attr:{},title:e.get_text(l,p)},n.each(c,function(a,b){g.attr[b]=(" "+(l.attr(b)||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig,
" ").replace(/^ /,"").replace(/ $/,"")}),-1!==n.inArray("languages",f.plugins)&&(n.isArray(f.languages)&&f.languages.length)&&n.each(f.languages,function(a,b){if(l.hasClass(b))return g.language=b,!0}),l.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(g.icon=l.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")),l.children("ins").get(0).style.backgroundImage.length&&(g.icon=l.children("ins").get(0).style.backgroundImage.replace("url(",
"").replace(")",""))):g=e.get_text(l);1<m.length?i.data.push(g):i.data=g});h=h.find("> ul > li");h.length&&(i.children=e.get_json(h,b,c,!0));k.push(i)});return k}}});var B=jQuery;B.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(a){var b=this._get_settings().languages,c=!1,d=".jstree-"+this.get_index()+" a";if(!B.isArray(b)||0===b.length)return!1;if(-1==B.inArray(a,b))if(b[a])a=b[a];else return!1;if(a==this.data.languages.current_language)return!0;
c=B.vakata.css.get_css(d+"."+this.data.languages.current_language,!1,this.data.languages.language_css);!1!==c&&(c.style.display="none");c=B.vakata.css.get_css(d+"."+a,!1,this.data.languages.language_css);!1!==c&&(c.style.display="");this.data.languages.current_language=a;this.__callback(a);return!0},get_lang:function(){return this.data.languages.current_language},_get_string:function(a,b){var c=this._get_settings().languages,d=this._get_settings().core.strings;B.isArray(c)&&c.length&&(b=b&&-1!=B.inArray(b,
c)?b:this.data.languages.current_language);return d[b]&&d[b][a]?d[b][a]:d[a]?d[a]:a},get_text:function(a,b){a=this._get_node(a)||this.data.ui.last_selected;if(!a.size())return!1;var c=this._get_settings().languages,d=this._get_settings().core.html_titles;B.isArray(c)&&c.length?(b=b&&-1!=B.inArray(b,c)?b:this.data.languages.current_language,a=a.children("a."+b)):a=a.children("a:eq(0)");if(d)return a=a.clone(),a.children("INS").remove(),a.html();a=a.contents().filter(function(){return 3==this.nodeType})[0];
return a.nodeValue},set_text:function(a,b,c){a=this._get_node(a)||this.data.ui.last_selected;if(!a.size())return!1;var d=this._get_settings().languages,k=this._get_settings().core.html_titles;B.isArray(d)&&d.length?(c=c&&-1!=B.inArray(c,d)?c:this.data.languages.current_language,a=a.children("a."+c)):a=a.children("a:eq(0)");if(k)return d=a.children("INS").clone(),a.html(b).prepend(d),this.__callback({obj:a,name:b,lang:c}),!0;a=a.contents().filter(function(){return 3==this.nodeType})[0];this.__callback({obj:a,
name:b,lang:c});return a.nodeValue=b},_load_css:function(){var a=this._get_settings().languages,b="/* languages css */",c=".jstree-"+this.get_index()+" a",d;if(B.isArray(a)&&a.length){this.data.languages.current_language=a[0];for(d=0;d<a.length;d++)b+=c+"."+a[d]+" {",a[d]!=this.data.languages.current_language&&(b+=" display:none; "),b+=" } ";this.data.languages.language_css=B.vakata.css.add_sheet({str:b,title:"jstree-languages"})}},create_node:function(a,b,c,d){return this.__call_old(!0,a,b,c,function(a){var b=
this._get_settings().languages,c=a.children("a"),e;if(B.isArray(b)&&b.length){for(e=0;e<b.length;e++)c.is("."+b[e])||a.append(c.eq(0).clone().removeClass(b.join(" ")).addClass(b[e]));c.not("."+b.join(", .")).remove()}d&&d.call(this,a)})}}});var E=jQuery;E.jstree.plugin("cookies",{__init:function(){if("undefined"===typeof E.cookie)throw"jsTree cookie: jQuery cookie plugin not included.";var a=this._get_settings().cookies,b;if(a.save_loaded&&(b=E.cookie(a.save_loaded))&&b.length)this.data.core.to_load=
b.split(",");if(a.save_opened&&(b=E.cookie(a.save_opened))&&b.length)this.data.core.to_open=b.split(",");if(a.save_selected&&(b=E.cookie(a.save_selected))&&b.length&&this.data.ui)this.data.ui.to_select=b.split(",");this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",E.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",E.proxy(function(a){this._get_settings().cookies.auto_save&&this.save_cookie((a.handleObj.namespace+
a.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(a){if(!this.data.core.refreshing){var b=this._get_settings().cookies;if(a)switch(a){case "open_node":case "close_node":b.save_opened&&(this.save_opened(),E.cookie(b.save_opened,this.data.core.to_open.join(","),b.cookie_options));b.save_loaded&&(this.save_loaded(),E.cookie(b.save_loaded,this.data.core.to_load.join(","),
b.cookie_options));break;case "select_node":case "deselect_node":b.save_selected&&this.data.ui&&(this.save_selected(),E.cookie(b.save_selected,this.data.ui.to_select.join(","),b.cookie_options))}else b.save_loaded&&(this.save_loaded(),E.cookie(b.save_loaded,this.data.core.to_load.join(","),b.cookie_options)),b.save_opened&&(this.save_opened(),E.cookie(b.save_opened,this.data.core.to_open.join(","),b.cookie_options)),b.save_selected&&this.data.ui&&(this.save_selected(),E.cookie(b.save_selected,this.data.ui.to_select.join(","),
b.cookie_options))}}}});var I=jQuery;I.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",I.proxy(function(a,b){var c=this._get_node(b.rslt.obj),c=-1===c?this.get_container().children("ul"):c.children("ul");this.sort(c)},this)).bind("rename_node.jstree create_node.jstree create.jstree",I.proxy(function(a,b){this.sort(b.rslt.obj.parent())},this)).bind("move_node.jstree",I.proxy(function(a,b){var c=-1==b.rslt.np?this.get_container():b.rslt.np;this.sort(c.children("ul"))},
this))},defaults:function(a,b){return this.get_text(a)>this.get_text(b)?1:-1},_fn:{sort:function(a){var b=this._get_settings().sort,c=this;a.append(I.makeArray(a.children("li")).sort(I.proxy(b,c)));a.find("> li > ul").each(function(){c.sort(I(this))});this.clean_node(a)}}});var e=jQuery,t=!1,m=!1,r=!1,l=!1,u=!1,v=!1,N=!1,O=!1,V=!1;e.vakata.dnd={is_down:!1,is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(a,b,c){e.vakata.dnd.is_drag&&
e.vakata.drag_stop({});try{a.currentTarget.unselectable="on",a.currentTarget.onselectstart=function(){return!1},a.currentTarget.style&&(a.currentTarget.style.MozUserSelect="none")}catch(d){}e.vakata.dnd.init_x=a.pageX;e.vakata.dnd.init_y=a.pageY;e.vakata.dnd.user_data=b;e.vakata.dnd.is_down=!0;e.vakata.dnd.helper=e("<div id='vakata-dragged' />").html(c);e(document).bind("mousemove",e.vakata.dnd.drag);e(document).bind("mouseup",e.vakata.dnd.drag_stop);return!1},drag:function(a){if(e.vakata.dnd.is_down){if(!e.vakata.dnd.is_drag)if(5<
Math.abs(a.pageX-e.vakata.dnd.init_x)||5<Math.abs(a.pageY-e.vakata.dnd.init_y))e.vakata.dnd.helper.appendTo("body"),e.vakata.dnd.is_drag=!0,e(document).triggerHandler("drag_start.vakata",{event:a,data:e.vakata.dnd.user_data});else return;if("mousemove"===a.type){var b=e(document),c=b.scrollTop(),b=b.scrollLeft();20>a.pageY-c?(v&&"down"===N&&(clearInterval(v),v=!1),v||(N="up",v=setInterval(function(){e(document).scrollTop(e(document).scrollTop()-e.vakata.dnd.scroll_spd)},150))):v&&"up"===N&&(clearInterval(v),
v=!1);20>e(window).height()-(a.pageY-c)?(v&&"up"===N&&(clearInterval(v),v=!1),v||(N="down",v=setInterval(function(){e(document).scrollTop(e(document).scrollTop()+e.vakata.dnd.scroll_spd)},150))):v&&"down"===N&&(clearInterval(v),v=!1);20>a.pageX-b?(u&&"right"===O&&(clearInterval(u),u=!1),u||(O="left",u=setInterval(function(){e(document).scrollLeft(e(document).scrollLeft()-e.vakata.dnd.scroll_spd)},150))):u&&"left"===O&&(clearInterval(u),u=!1);20>e(window).width()-(a.pageX-b)?(u&&"left"===O&&(clearInterval(u),
u=!1),u||(O="right",u=setInterval(function(){e(document).scrollLeft(e(document).scrollLeft()+e.vakata.dnd.scroll_spd)},150))):u&&"right"===O&&(clearInterval(u),u=!1)}e.vakata.dnd.helper.css({left:a.pageX+e.vakata.dnd.helper_left+"px",top:a.pageY+e.vakata.dnd.helper_top+"px"});e(document).triggerHandler("drag.vakata",{event:a,data:e.vakata.dnd.user_data})}},drag_stop:function(a){u&&clearInterval(u);v&&clearInterval(v);e(document).unbind("mousemove",e.vakata.dnd.drag);e(document).unbind("mouseup",e.vakata.dnd.drag_stop);
e(document).triggerHandler("drag_stop.vakata",{event:a,data:e.vakata.dnd.user_data});e.vakata.dnd.helper.remove();e.vakata.dnd.init_x=0;e.vakata.dnd.init_y=0;e.vakata.dnd.user_data={};e.vakata.dnd.is_down=!1;e.vakata.dnd.is_drag=!1}};e(function(){e.vakata.css.add_sheet({str:"#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ",title:"vakata"})});e.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,
after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1,mto:!1};this.get_container().bind("mouseenter.jstree",e.proxy(function(a){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&(this.data.themes&&(r.attr("class","jstree-"+this.data.themes.theme),l&&l.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),a.currentTarget===a.target&&(e.vakata.dnd.user_data.obj&&e(e.vakata.dnd.user_data.obj).length&&
e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==a.target)&&(a=e.jstree._reference(a.target),a.data.dnd.foreign?(a=a._get_settings().dnd.drag_check.call(this,{o:t,r:a.get_container(),is_root:!0}),(!0===a||!0===a.inside||!0===a.before||!0===a.after)&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok")):(a.prepare_move(t,a.get_container(),"last"),a.check_move()&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok"))))},this)).bind("mouseup.jstree",e.proxy(function(a){if(e.vakata.dnd.is_drag&&
e.vakata.dnd.user_data.jstree&&a.currentTarget===a.target&&e.vakata.dnd.user_data.obj&&e(e.vakata.dnd.user_data.obj).length&&e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==a.target){var c=e.jstree._reference(a.currentTarget);c.data.dnd.foreign?(a=c._get_settings().dnd.drag_check.call(this,{o:t,r:c.get_container(),is_root:!0}),(!0===a||!0===a.inside||!0===a.before||!0===a.after)&&c._get_settings().dnd.drag_finish.call(this,{o:t,r:c.get_container(),is_root:!0})):c.move_node(t,c.get_container(),
"last",a[c._get_settings().dnd.copy_modifier+"Key"])}},this)).bind("mouseleave.jstree",e.proxy(function(a){if(a.relatedTarget&&a.relatedTarget.id&&"jstree-marker-line"===a.relatedTarget.id)return!1;e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),e.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&
e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"))},this)).bind("mousemove.jstree",e.proxy(function(a){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){var c=this.get_container()[0];a.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(e.proxy(function(){this.scrollLeft+=e.vakata.dnd.scroll_spd},c),100)):a.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=
setInterval(e.proxy(function(){this.scrollLeft-=e.vakata.dnd.scroll_spd},c),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1);a.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(e.proxy(function(){this.scrollTop+=e.vakata.dnd.scroll_spd},c),100)):a.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(e.proxy(function(){this.scrollTop-=e.vakata.dnd.scroll_spd},
c),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).bind("scroll.jstree",e.proxy(function(){e.vakata.dnd.is_drag&&(e.vakata.dnd.user_data.jstree&&r&&l)&&(r.hide(),l.hide())},this)).delegate("a","mousedown.jstree",e.proxy(function(a){if(1===a.which)return this.start_drag(a.currentTarget,a),!1},this)).delegate("a","mouseenter.jstree",e.proxy(function(a){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&this.dnd_enter(a.currentTarget)},this)).delegate("a","mousemove.jstree",e.proxy(function(a){e.vakata.dnd.is_drag&&
e.vakata.dnd.user_data.jstree&&((!m||!m.length||m.children("a")[0]!==a.currentTarget)&&this.dnd_enter(a.currentTarget),"undefined"===typeof this.data.dnd.off.top&&(this.data.dnd.off=e(a.target).offset()),this.data.dnd.w=(a.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,0>this.data.dnd.w&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",e.proxy(function(a){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){if(a.relatedTarget&&a.relatedTarget.id&&
"jstree-marker-line"===a.relatedTarget.id)return!1;r&&r.hide();l&&l.hide();var c=this;this.data.dnd.mto=setTimeout(function(){c.dnd_leave(a)},0)}},this)).delegate("a","mouseup.jstree",e.proxy(function(a){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&this.dnd_finish(a)},this));e(document).bind("drag_stop.vakata",e.proxy(function(){this.data.dnd.to1&&clearTimeout(this.data.dnd.to1);this.data.dnd.to2&&clearTimeout(this.data.dnd.to2);this.data.dnd.i1&&clearInterval(this.data.dnd.i1);this.data.dnd.i2&&
clearInterval(this.data.dnd.i2);this.data.dnd.after=!1;this.data.dnd.before=!1;this.data.dnd.inside=!1;this.data.dnd.off=!1;this.data.dnd.prepared=!1;this.data.dnd.w=!1;this.data.dnd.to1=!1;this.data.dnd.to2=!1;this.data.dnd.i1=!1;this.data.dnd.i2=!1;this.data.dnd.active=!1;this.data.dnd.foreign=!1;r&&r.css({top:"-2000px"});l&&l.css({top:"-2000px"})},this)).bind("drag_start.vakata",e.proxy(function(a,c){if(c.data.jstree){var d=e(c.event.target);d.closest(".jstree").hasClass("jstree-"+this.get_index())&&
this.dnd_enter(d)}},this));var a=this._get_settings().dnd;a.drag_target&&e(document).delegate(a.drag_target,"mousedown.jstree-"+this.get_index(),e.proxy(function(a){t=a.target;e.vakata.dnd.drag_start(a,{jstree:!0,obj:a.target},"<ins class='jstree-icon'></ins>"+e(a.target).text());this.data.themes&&(r&&r.attr("class","jstree-"+this.data.themes.theme),l&&l.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));e.vakata.dnd.helper.children("ins").attr("class",
"jstree-invalid");var c=this.get_container();this.data.dnd.cof=c.offset();this.data.dnd.cw=parseInt(c.width(),10);this.data.dnd.ch=parseInt(c.height(),10);this.data.dnd.foreign=!0;a.preventDefault()},this));a.drop_target&&e(document).delegate(a.drop_target,"mouseenter.jstree-"+this.get_index(),e.proxy(function(a){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:t,r:e(a.target),e:a})&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok")},this)).delegate(a.drop_target,
"mouseleave.jstree-"+this.get_index(),e.proxy(function(){this.data.dnd.active&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(a.drop_target,"mouseup.jstree-"+this.get_index(),e.proxy(function(a){this.data.dnd.active&&e.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:t,r:e(a.target),e:a})},this))},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(){return!0},
drop_finish:e.noop,drag_target:".jstree-draggable",drag_finish:e.noop,drag_check:function(){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(m&&m.length){this.data.dnd.off=m.offset();this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+m.width());if(this.data.dnd.foreign){var a=this._get_settings().dnd.drag_check.call(this,{o:t,r:m});this.data.dnd.after=a.after;this.data.dnd.before=a.before;this.data.dnd.inside=a.inside;this.data.dnd.prepared=!0;return this.dnd_show()}this.prepare_move(t,
m,"before");this.data.dnd.before=this.check_move();this.prepare_move(t,m,"after");this.data.dnd.after=this.check_move();this._is_loaded(m)?(this.prepare_move(t,m,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1;this.data.dnd.prepared=!0;return this.dnd_show()}},dnd_show:function(){if(this.data.dnd.prepared){var a=["before","inside","after"],b=!1,c=this._get_settings().core.rtl,a=this.data.dnd.w<this.data.core.li_height/3?["before","inside","after"]:this.data.dnd.w<=2*this.data.core.li_height/
3?this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:["after","inside","before"];e.each(a,e.proxy(function(a,c){if(this.data.dnd[c])return e.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),b=c,!1},this));!1===b&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");a=c?this.data.dnd.off.right-18:this.data.dnd.off.left+10;switch(b){case "before":r.css({left:a+"px",top:this.data.dnd.off.top-6+"px"}).show();l&&l.css({left:a+8+"px",
top:this.data.dnd.off.top-1+"px"}).show();break;case "after":r.css({left:a+"px",top:this.data.dnd.off.top+this.data.core.li_height-6+"px"}).show();l&&l.css({left:a+8+"px",top:this.data.dnd.off.top+this.data.core.li_height-1+"px"}).show();break;case "inside":r.css({left:a+(c?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show();l&&l.hide();break;default:r.hide(),l&&l.hide()}return V=b}},dnd_open:function(){this.data.dnd.to2=!1;this.open_node(m,e.proxy(this.dnd_prepare,this),
!0)},dnd_finish:function(a){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:t,r:m,p:V}):(this.dnd_prepare(),this.move_node(t,m,V,a[this._get_settings().dnd.copy_modifier+"Key"]));m=t=!1;r.hide();l&&l.hide()},dnd_enter:function(a){this.data.dnd.mto&&(clearTimeout(this.data.dnd.mto),this.data.dnd.mto=!1);var b=this._get_settings().dnd;this.data.dnd.prepared=!1;m=this._get_node(a);b.check_timeout?(this.data.dnd.to1&&
clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout(e.proxy(this.dnd_prepare,this),b.check_timeout)):this.dnd_prepare();b.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),m&&(m.length&&m.hasClass("jstree-closed"))&&(this.data.dnd.to2=setTimeout(e.proxy(this.dnd_open,this),b.open_timeout))):m&&(m.length&&m.hasClass("jstree-closed"))&&this.dnd_open()},dnd_leave:function(a){this.data.dnd.after=!1;this.data.dnd.before=!1;this.data.dnd.inside=!1;e.vakata.dnd.helper.children("ins").attr("class",
"jstree-invalid");r.hide();l&&l.hide();m&&m[0]===a.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2&&(clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1))},start_drag:function(a,b){t=this._get_node(a);this.data.ui&&this.is_selected(t)&&(t=this._get_node(null,!0));var c=1<t.length?this._get_string("multiple_selection"):this.get_text(t),d=this.get_container();this._get_settings().core.html_titles||(c=c.replace(/</ig,"&lt;").replace(/>/ig,
"&gt;"));e.vakata.dnd.drag_start(b,{jstree:!0,obj:t},"<ins class='jstree-icon'></ins>"+c);this.data.themes&&(r&&r.attr("class","jstree-"+this.data.themes.theme),l&&l.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));this.data.dnd.cof=d.offset();this.data.dnd.cw=parseInt(d.width(),10);this.data.dnd.ch=parseInt(d.height(),10);this.data.dnd.active=!0}}});e(function(){e.vakata.css.add_sheet({str:"#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }",
title:"jstree"});r=e("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(a){r.hide();l.hide();a.preventDefault();a.stopImmediatePropagation();return!1}).appendTo("body");l=e("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(a){if(m&&m.length)return m.children("a").trigger(a),a.preventDefault(),a.stopImmediatePropagation(),!1}).bind("mouseleave",function(a){var b=e(a.relatedTarget);if((b.is(".jstree")||0===b.closest(".jstree").length)&&
m&&m.length)return m.children("a").trigger(a),r.hide(),l.hide(),a.preventDefault(),a.stopImmediatePropagation(),!1}).appendTo("body");e(document).bind("drag_start.vakata",function(a,b){b.data.jstree&&(r.show(),l&&l.show())});e(document).bind("drag_stop.vakata",function(a,b){b.data.jstree&&(r.hide(),l&&l.hide())})});var F=jQuery;F.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui;this.data.ui&&this.data.checkbox.noui&&(this.select_node=this.deselect_node=
this.deselect_all=F.noop,this.get_selected=this.get_checked);this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",F.proxy(function(a,b){this._prepare_checkboxes(b.rslt.obj)},this)).bind("loaded.jstree",F.proxy(function(){this._prepare_checkboxes()},this)).delegate(this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox","click.jstree",F.proxy(function(a){a.preventDefault();this._get_node(a.target).hasClass("jstree-checked")?this.uncheck_node(a.target):
this.check_node(a.target);if(this.data.ui&&this.data.checkbox.noui)this.save_selected(),this.data.cookies&&this.save_cookie("select_node");else return a.stopImmediatePropagation(),!1},this))},defaults:{override_ui:!1,two_state:!1,real_checkboxes:!1,checked_parent_open:!0,real_checkboxes_names:function(a){return["check_"+(a[0].id||Math.ceil(1E4*Math.random())),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},
_fn:{_checkbox_notify:function(a,b){b.checked&&this.check_node(a,!1)},_prepare_checkboxes:function(a){a=!a||-1==a?this.get_container().find("> ul > li"):this._get_node(a);if(!1!==a){var b,c=this,d,e=this._get_settings().checkbox.two_state,f=this._get_settings().checkbox.real_checkboxes,j=this._get_settings().checkbox.real_checkboxes_names;a.each(function(){d=F(this);b=d.is("li")&&(d.hasClass("jstree-checked")||f&&d.children(":checked").length)?"jstree-checked":"jstree-unchecked";d.find("li").andSelf().each(function(){var a=
F(this),d;a.children("a"+(c.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(e?"jstree-unchecked":b);f&&(a.children(":checkbox").length?a.children(":checkbox").addClass("jstree-real-checkbox"):(d=j.call(c,a),a.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+d[0]+"' name='"+d[0]+"' value='"+d[1]+"' />")));e?(a.hasClass("jstree-checked")||a.children(":checked").length)&&
a.addClass("jstree-checked").children(":checkbox").prop("checked",!0):("jstree-checked"===b||a.hasClass("jstree-checked")||a.children(":checked").length)&&a.find("li").andSelf().addClass("jstree-checked").children(":checkbox").prop("checked",!0)})});e||a.find(".jstree-checked").parent().parent().each(function(){c._repair_state(this)})}},change_state:function(a,b){var a=this._get_node(a),c=!1,d=this._get_settings().checkbox.real_checkboxes;if(!a||-1===a)return!1;b=!1===b||!0===b?b:a.hasClass("jstree-checked");
if(this._get_settings().checkbox.two_state)b?(a.removeClass("jstree-checked").addClass("jstree-unchecked"),d&&a.children(":checkbox").prop("checked",!1)):(a.removeClass("jstree-unchecked").addClass("jstree-checked"),d&&a.children(":checkbox").prop("checked",!0));else{if(b){c=a.find("li").andSelf();if(!c.filter(".jstree-checked, .jstree-undetermined").length)return!1;c.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");d&&c.children(":checkbox").prop("checked",!1)}else{c=
a.find("li").andSelf();if(!c.filter(".jstree-unchecked, .jstree-undetermined").length)return!1;c.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");d&&c.children(":checkbox").prop("checked",!0);this.data.ui&&(this.data.ui.last_selected=a);this.data.checkbox.last_selected=a}a.parentsUntil(".jstree","li").each(function(){var a=F(this);if(b){if(a.children("ul").children("li.jstree-checked, li.jstree-undetermined").length)return a.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),
d&&a.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",!1),!1;a.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");d&&a.children(":checkbox").prop("checked",!1)}else{if(a.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length)return a.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),d&&a.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",
!1),!1;a.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");d&&a.children(":checkbox").prop("checked",!0)}})}this.data.ui&&this.data.checkbox.noui&&(this.data.ui.selected=this.get_checked());this.__callback(a);return!0},check_node:function(a){if(this.change_state(a,!1)){a=this._get_node(a);if(this._get_settings().checkbox.checked_parent_open){var b=this;a.parents(".jstree-closed").each(function(){b.open_node(this,!1,!0)})}this.__callback({obj:a})}},uncheck_node:function(a){this.change_state(a,
!0)&&this.__callback({obj:this._get_node(a)})},check_all:function(){var a=this;(this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li")).each(function(){a.change_state(this,!1)});this.__callback()},uncheck_all:function(){var a=this;(this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li")).each(function(){a.change_state(this,!0)});this.__callback()},is_checked:function(a){a=this._get_node(a);
return a.length?a.is(".jstree-checked"):!1},get_checked:function(a,b){a=!a||-1===a?this.get_container():this._get_node(a);return b||this._get_settings().checkbox.two_state?a.find(".jstree-checked"):a.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(a,b){a=!a||-1===a?this.get_container():this._get_node(a);return b||this._get_settings().checkbox.two_state?a.find(".jstree-unchecked"):a.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},
show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(a){a=this._get_node(a);if(a.length)if(this._get_settings().checkbox.two_state)a.find("li").andSelf().not(".jstree-checked").removeClass("jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked",!0);else{var b=this._get_settings().checkbox.real_checkboxes,
c=a.find("> ul > .jstree-checked").length,d=a.find("> ul > .jstree-undetermined").length,e=a.find("> ul > li").length;0===e?a.hasClass("jstree-undetermined")&&this.change_state(a,!1):0===c&&0===d?this.change_state(a,!0):c===e?this.change_state(a,!1):(a.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),b&&a.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",!1))}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var a=
this,b=this.data.ui.to_select,b=F.map(F.makeArray(b),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});this.deselect_all();F.each(b,function(b,d){a.check_node(d)});this.__callback()}else this.__call_old()},save_loaded:function(){var a=this;this.data.core.to_load=[];this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){this.id&&a.data.core.to_load.push("#"+this.id)})}}});
F(function(){F.vakata.css.add_sheet({str:".jstree .jstree-real-checkbox { display:none; } ",title:"jstree"})});var p=jQuery;p.vakata.xslt=function(a,b,c){var d="",e,f,j;if(document.recalc)return e=document.createElement("xml"),f=document.createElement("xml"),e.innerHTML=a,f.innerHTML=b,p("body").append(e).append(f),setTimeout(function(){c.call(null,e.transformNode(f.XMLDocument));setTimeout(function(){p(e).remove();p(f).remove()},200)},100),!0;"undefined"!==typeof window.DOMParser&&("undefined"!==
typeof window.XMLHttpRequest&&"undefined"===typeof window.XSLTProcessor)&&(a=(new DOMParser).parseFromString(a,"text/xml"),b=(new DOMParser).parseFromString(b,"text/xml"));if("undefined"!==typeof window.DOMParser&&"undefined"!==typeof window.XMLHttpRequest&&"undefined"!==typeof window.XSLTProcessor){j=new XSLTProcessor;d=p.isFunction(j.transformDocument)?"undefined"!==typeof window.XMLSerializer:!0;if(!d)return!1;a=(new DOMParser).parseFromString(a,"text/xml");b=(new DOMParser).parseFromString(b,
"text/xml");p.isFunction(j.transformDocument)?(d=document.implementation.createDocument("","",null),j.transformDocument(a,b,d,null),c.call(null,(new XMLSerializer).serializeToString(d))):(j.importStylesheet(b),d=j.transformToFragment(a,document),c.call(null,p("<div />").append(d).html()));return!0}return!1};var $={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">\t<xsl:call-template name="nodes">\t\t<xsl:with-param name="node" select="/root" />\t</xsl:call-template></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<ul>\t<xsl:for-each select="$node/item">\t\t<xsl:variable name="children" select="count(./item) &gt; 0" />\t\t<li>\t\t\t<xsl:attribute name="class">\t\t\t\t<xsl:if test="position() = last()">jstree-last </xsl:if>\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t\t\t</xsl:choose>\t\t\t\t<xsl:value-of select="@class" />\t\t\t</xsl:attribute>\t\t\t<xsl:for-each select="@*">\t\t\t\t<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t</xsl:if>\t\t\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t\t\t<xsl:for-each select="content/name">\t\t\t\t<a>\t\t\t\t<xsl:attribute name="href">\t\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t\t\t</xsl:choose>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t\t\t<xsl:for-each select="@*">\t\t\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t\t</xsl:if>\t\t\t\t</xsl:for-each>\t\t\t\t\t<ins>\t\t\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t\t\t</xsl:attribute>\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t\t\t</ins>\t\t\t\t\t<xsl:copy-of select="./child::node()" />\t\t\t\t</a>\t\t\t</xsl:for-each>\t\t\t<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>\t\t</li>\t</xsl:for-each>\t</ul></xsl:template></xsl:stylesheet>',
flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">\t<ul>\t<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">\t\t<xsl:call-template name="nodes">\t\t\t<xsl:with-param name="node" select="." />\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t</xsl:call-template>\t</xsl:for-each>\t</ul></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<xsl:param name="is_last" />\t<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />\t<li>\t<xsl:attribute name="class">\t\t<xsl:if test="$is_last = true()">jstree-last </xsl:if>\t\t<xsl:choose>\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t</xsl:choose>\t\t<xsl:value-of select="@class" />\t</xsl:attribute>\t<xsl:for-each select="@*">\t\t<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t</xsl:if>\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t<xsl:for-each select="content/name">\t\t<a>\t\t<xsl:attribute name="href">\t\t\t<xsl:choose>\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t</xsl:choose>\t\t</xsl:attribute>\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t<xsl:for-each select="@*">\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t</xsl:if>\t\t</xsl:for-each>\t\t\t<ins>\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t</ins>\t\t\t<xsl:copy-of select="./child::node()" />\t\t</a>\t</xsl:for-each>\t<xsl:if test="$children">\t\t<ul>\t\t<xsl:for-each select="//item[@parent_id=$node/attribute::id]">\t\t\t<xsl:call-template name="nodes">\t\t\t\t<xsl:with-param name="node" select="." />\t\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t\t</xsl:call-template>\t\t</xsl:for-each>\t\t</ul>\t</xsl:if>\t</li></xsl:template></xsl:stylesheet>'},
P=function(a){return a.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};p.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0,get_skip_empty:!1,get_include_preamble:!0},_fn:{load_node:function(a,b,c){var d=this;this.load_node_xml(a,function(){d.__callback({obj:d._get_node(a)});b.call(this)},c)},_is_loaded:function(a){var b=this._get_settings().xml_data,a=this._get_node(a);return-1==a||
!a||!b.ajax&&!p.isFunction(b.data)||a.is(".jstree-open, .jstree-leaf")||0<a.children("ul").children("li").size()},load_node_xml:function(a,b,c){var d=this.get_settings().xml_data,e=function(){},f=function(){};if((a=this._get_node(a))&&-1!==a){if(a.data("jstree_is_loading"))return;a.data("jstree_is_loading",!0)}switch(!0){case !d.data&&!d.ajax:throw"Neither data nor ajax settings supplied.";case p.isFunction(d.data):d.data.call(this,a,p.proxy(function(c){this.parse_xml(c,p.proxy(function(c){c&&(c=
c.replace(/ ?xmlns="[^"]*"/ig,""),10<c.length?(c=p(c),-1===a||!a?this.get_container().children("ul").empty().append(c.children()):(a.children("a.jstree-loading").removeClass("jstree-loading"),a.append(c),a.removeData("jstree_is_loading")),d.clean_node&&this.clean_node(a),b&&b.call(this)):a&&-1!==a?(a.children("a.jstree-loading").removeClass("jstree-loading"),a.removeData("jstree_is_loading"),d.correct_state&&(this.correct_state(a),b&&b.call(this))):d.correct_state&&(this.get_container().children("ul").empty(),
b&&b.call(this)))},this))},this));break;case !!d.data&&!d.ajax||!!d.data&&!!d.ajax&&(!a||-1===a):(!a||-1==a)&&this.parse_xml(d.data,p.proxy(function(c){c?(c=c.replace(/ ?xmlns="[^"]*"/ig,""),10<c.length&&(c=p(c),this.get_container().children("ul").empty().append(c.children()),d.clean_node&&this.clean_node(a),b&&b.call(this))):d.correct_state&&(this.get_container().children("ul").empty(),b&&b.call(this))},this));break;case !d.data&&!!d.ajax||!!d.data&&!!d.ajax&&a&&-1!==a:e=function(b,f,e){var k=this.get_settings().xml_data.ajax.error;
k&&k.call(this,b,f,e);-1!==a&&a.length?(a.children("a.jstree-loading").removeClass("jstree-loading"),a.removeData("jstree_is_loading"),"success"===f&&d.correct_state&&this.correct_state(a)):"success"===f&&d.correct_state&&this.get_container().children("ul").empty();c&&c.call(this)},f=function(c,f,g){var c=g.responseText,h=this.get_settings().xml_data.ajax.success;h&&(c=h.call(this,c,f,g)||c);if(""===c||c&&c.toString&&""===c.toString().replace(/^[\s\n]+$/,""))return e.call(this,g,f,"");this.parse_xml(c,
p.proxy(function(c){c&&(c=c.replace(/ ?xmlns="[^"]*"/ig,""),10<c.length?(c=p(c),-1===a||!a?this.get_container().children("ul").empty().append(c.children()):(a.children("a.jstree-loading").removeClass("jstree-loading"),a.append(c),a.removeData("jstree_is_loading")),d.clean_node&&this.clean_node(a),b&&b.call(this)):a&&-1!==a?(a.children("a.jstree-loading").removeClass("jstree-loading"),a.removeData("jstree_is_loading"),d.correct_state&&(this.correct_state(a),b&&b.call(this))):d.correct_state&&(this.get_container().children("ul").empty(),
b&&b.call(this)))},this))},d.ajax.context=this,d.ajax.error=e,d.ajax.success=f,d.ajax.dataType||(d.ajax.dataType="xml"),p.isFunction(d.ajax.url)&&(d.ajax.url=d.ajax.url.call(this,a)),p.isFunction(d.ajax.data)&&(d.ajax.data=d.ajax.data.call(this,a)),p.ajax(d.ajax)}},parse_xml:function(a,b){var c=this._get_settings().xml_data;p.vakata.xslt(a,$[c.xsl],b)},get_xml:function(a,b,c,d,e){var f="",j=this._get_settings(),i=this,g,h,l,m,n;a||(a="flat");e||(e=0);b=this._get_node(b);if(!b||-1===b)b=this.get_container().find("> ul > li");
c=p.isArray(c)?c:["id","class"];!e&&(this.data.types&&-1===p.inArray(j.types.type_attr,c))&&c.push(j.types.type_attr);d=p.isArray(d)?d:[];e||(j.xml_data.get_include_preamble&&(f+='<?xml version="1.0" encoding="UTF-8"?>'),f+="<root>");b.each(function(){f+="<item";l=p(this);p.each(c,function(a,b){var c=l.attr(b);if(!j.xml_data.get_skip_empty||"undefined"!==typeof c)f+=" "+b+'="'+P((" "+(c||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'});l.hasClass("jstree-open")&&
(f+=' state="open"');l.hasClass("jstree-closed")&&(f+=' state="closed"');"flat"===a&&(f+=' parent_id="'+P(e)+'"');f+=">";f+="<content>";m=l.children("a");m.each(function(){g=p(this);n=!1;f+="<name";-1!==p.inArray("languages",j.plugins)&&p.each(j.languages,function(a,b){if(g.hasClass(b))return f+=' lang="'+P(b)+'"',n=b,!1});d.length&&p.each(d,function(a,b){var c=g.attr(b);if(!j.xml_data.get_skip_empty||"undefined"!==typeof c)f+=" "+b+'="'+P((" "+c||"").replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig,
" ").replace(/^ /,"").replace(/ $/,""))+'"'});g.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(f+=' icon="'+P(g.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"');g.children("ins").get(0).style.backgroundImage.length&&(f+=' icon="'+P(g.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"');f+=">";f+="<![CDATA["+
i.get_text(g,n)+"]]\>";f+="</name>"});f+="</content>";h=l[0].id||!0;l=l.find("> ul > li");h=l.length?i.get_xml(a,l,c,d,h):"";"nest"==a&&(f+=h);f+="</item>";"flat"==a&&(f+=h)});e||(f+="</root>");return f}}});var y=jQuery;y.expr[":"].jstree_contains=function(a,b,c){return 0<=(a.textContent||a.innerText||"").toLowerCase().indexOf(c[3].toLowerCase())};y.expr[":"].jstree_title_contains=function(a,b,c){return 0<=(a.getAttribute("title")||"").toLowerCase().indexOf(c[3].toLowerCase())};y.jstree.plugin("search",
{__init:function(){this.data.search.str="";this.data.search.result=y();this._get_settings().search.show_only_matches&&this.get_container().bind("search.jstree",function(a,b){y(this).children("ul").find("li").hide().removeClass("jstree-last");b.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function(){y(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){y(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",
-1)})},defaults:{ajax:!1,search_method:"jstree_contains",show_only_matches:!1},_fn:{search:function(a,b){if(""===y.trim(a))this.clear_search();else{var c=this.get_settings().search,d=this,e=function(){};this.data.search.str=a;if(!b&&!1!==c.ajax&&0<this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length){this.search.supress_callback=!0;e=function(a,b,c){var d=this.get_settings().search.ajax.success;d&&(a=d.call(this,a,b,c)||a);this.data.search.to_open=a;this._search_open()};c.ajax.context=
this;c.ajax.error=function(){};c.ajax.success=e;y.isFunction(c.ajax.url)&&(c.ajax.url=c.ajax.url.call(this,a));y.isFunction(c.ajax.data)&&(c.ajax.data=c.ajax.data.call(this,a));c.ajax.data||(c.ajax.data={search_string:a});if(!c.ajax.dataType||/^json/.exec(c.ajax.dataType))c.ajax.dataType="json";y.ajax(c.ajax)}else this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+c.search_method+"("+this.data.search.str+
")"),this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){d.open_node(this,!1,!0)}),this.__callback({nodes:this.data.search.result,str:a})}},clear_search:function(){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);this.data.search.result=y()},_search_open:function(){var a=this,b=!0,c=[],d=[];this.data.search.to_open.length&&(y.each(this.data.search.to_open,function(a,b){if("#"==b)return!0;y(b).length&&y(b).is(".jstree-closed")?
c.push(b):d.push(b)}),c.length&&(this.data.search.to_open=d,y.each(c,function(b,c){a.open_node(c,function(){a._search_open(!0)})}),b=!1));b&&this.search(this.data.search.str,!0)}}});var h=jQuery;h.vakata.context={hide_on_mouseleave:!1,cnt:h("<div id='vakata-contextmenu' />"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,rtl:!1,show:function(a,b,c,d,e,f,j){h.vakata.context.rtl=!!j;if(a=h.vakata.context.parse(a)){h.vakata.context.vis=!0;h.vakata.context.tgt=b;h.vakata.context.par=f||b||null;h.vakata.context.data=
e||null;h.vakata.context.cnt.html(a).css({visibility:"hidden",display:"block",left:0,top:0});if(h.vakata.context.hide_on_mouseleave)h.vakata.context.cnt.one("mouseleave",function(){h.vakata.context.hide()});e=h.vakata.context.cnt.height();f=h.vakata.context.cnt.width();c+f>h(document).width()&&(c=h(document).width()-(f+5),h.vakata.context.cnt.find("li > ul").addClass("right"));d+e>h(document).height()&&(d-=e+b[0].offsetHeight,h.vakata.context.cnt.find("li > ul").addClass("bottom"));h.vakata.context.cnt.css({left:c,
top:d}).find("li:has(ul)").bind("mouseenter",function(){var a=h(document).width(),b=h(document).height(),c=h(this).children("ul").show();a!==h(document).width()&&c.toggleClass("right");b!==h(document).height()&&c.toggleClass("bottom")}).bind("mouseleave",function(){h(this).children("ul").hide()}).end().css({visibility:"visible"}).show();h(document).triggerHandler("context_show.vakata")}},hide:function(){h.vakata.context.vis=!1;h.vakata.context.cnt.attr("class","").css({visibility:"hidden"});h(document).triggerHandler("context_hide.vakata")},
parse:function(a,b){if(!a)return!1;var c="",d=!1,e=!0;b||(h.vakata.context.func={});c+="<ul>";h.each(a,function(a,b){if(!b)return!0;h.vakata.context.func[a]=b.action;!e&&b.separator_before&&(c+="<li class='vakata-separator vakata-separator-before'></li>");e=!1;c+="<li class='"+(b._class||"")+(b._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ";b.icon&&-1===b.icon.indexOf("/")&&(c+=" class='"+b.icon+"' ");b.icon&&-1!==b.icon.indexOf("/")&&(c+=" style='background:url("+b.icon+") center center no-repeat;' ");
c+=">&#160;</ins><a href='#' rel='"+a+"'>";b.submenu&&(c+="<span style='float:"+(h.vakata.context.rtl?"left":"right")+";'>&raquo;</span>");c+=b.label+"</a>";b.submenu&&(d=h.vakata.context.parse(b.submenu,!0))&&(c+=d);c+="</li>";b.separator_after&&(c+="<li class='vakata-separator vakata-separator-after'></li>",e=!0)});c=c.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,"");c+="</ul>";h(document).triggerHandler("context_parse.vakata");return 10<c.length?c:!1},exec:function(a){return h.isFunction(h.vakata.context.func[a])?
(h.vakata.context.func[a].call(h.vakata.context.data,h.vakata.context.par),!0):!1}};h(function(){h.vakata.css.add_sheet({str:"#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ",
title:"vakata"});h.vakata.context.cnt.delegate("a","click",function(a){a.preventDefault()}).delegate("a","mouseup",function(){!h(this).parent().hasClass("jstree-contextmenu-disabled")&&h.vakata.context.exec(h(this).attr("rel"))?h.vakata.context.hide():h(this).blur()}).delegate("a","mouseover",function(){h.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body");h(document).bind("mousedown",function(a){h.vakata.context.vis&&!h.contains(h.vakata.context.cnt[0],a.target)&&
h.vakata.context.hide()});"undefined"!==typeof h.hotkeys&&h(document).bind("keydown","up",function(a){if(h.vakata.context.vis){var b=h.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();b.length||(b=h.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last());b.addClass("vakata-hover");a.stopImmediatePropagation();a.preventDefault()}}).bind("keydown","down",function(a){if(h.vakata.context.vis){var b=
h.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();b.length||(b=h.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first());b.addClass("vakata-hover");a.stopImmediatePropagation();a.preventDefault()}}).bind("keydown","right",function(a){h.vakata.context.vis&&(h.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),
a.stopImmediatePropagation(),a.preventDefault())}).bind("keydown","left",function(a){h.vakata.context.vis&&(h.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),a.stopImmediatePropagation(),a.preventDefault())}).bind("keydown","esc",function(a){h.vakata.context.hide();a.preventDefault()}).bind("keydown","space",function(a){h.vakata.context.cnt.find(".vakata-hover").last().children("a").click();a.preventDefault()})});h.jstree.plugin("contextmenu",
{__init:function(){this.get_container().delegate("a","contextmenu.jstree",h.proxy(function(a){a.preventDefault();h(a.currentTarget).hasClass("jstree-loading")||this.show_contextmenu(a.currentTarget,a.pageX,a.pageY)},this)).delegate("a","click.jstree",h.proxy(function(){this.data.contextmenu&&h.vakata.context.hide()},this)).bind("destroy.jstree",h.proxy(function(){this.data.contextmenu&&h.vakata.context.hide()},this));h(document).bind("context_hide.vakata",h.proxy(function(){this.data.contextmenu=
!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(a){this.create(a)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(a){this.rename(a)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(a){this.is_selected(a)?this.remove():this.remove(a)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,
separator_after:!1,label:"Cut",action:function(a){this.cut(a)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(a){this.copy(a)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(a){this.paste(a)}}}}}},_fn:{show_contextmenu:function(a,b,c){var a=this._get_node(a),d=this.get_settings().contextmenu,e=a.children("a:visible:eq(0)"),f=!1,f=!1;d.select_node&&(this.data.ui&&!this.is_selected(a))&&(this.deselect_all(),this.select_node(a,
!0));if(d.show_at_node||"undefined"===typeof b||"undefined"===typeof c)f=e.offset(),b=f.left,c=f.top+this.data.core.li_height;f=a.data("jstree")&&a.data("jstree").contextmenu?a.data("jstree").contextmenu:d.items;h.isFunction(f)&&(f=f.call(this,a));this.data.contextmenu=!0;h.vakata.context.show(f,e,b,c,this,a,this._get_settings().core.rtl);this.data.themes&&h.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}});var C=jQuery;C.jstree.plugin("types",{__init:function(){var a=
this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",C.proxy(function(){var b=a.type_attr,c="",d=this;C.each(a.types,function(a,f){C.each(f,function(a){/^(max_depth|max_children|icon|valid_children)$/.test(a)||d.data.types.attach_to.push(a)});if(!f.icon)return!0;if(f.icon.image||f.icon.position)c="default"==a?c+(".jstree-"+d.get_index()+" a > .jstree-icon { "):c+(".jstree-"+d.get_index()+" li["+b+'="'+a+'"] > a > .jstree-icon { '),f.icon.image&&(c+=" background-image:url("+
f.icon.image+"); "),c=f.icon.position?c+(" background-position:"+f.icon.position+"; "):c+" background-position:0 0; ",c+="} "});""!==c&&C.vakata.css.add_sheet({str:c,title:"jstree-types"})},this)).bind("before.jstree",C.proxy(function(a,c){var d,e;if((d=(d=this._get_settings().types.use_data?this._get_node(c.args[0]):!1)&&-1!==d&&d.length?d.data("jstree"):!1)&&d.types&&!1===d.types[c.func])return a.stopImmediatePropagation(),!1;if(-1!==C.inArray(c.func,this.data.types.attach_to)&&c.args[0]&&(c.args[0].tagName||
c.args[0].jquery))if(d=this._get_settings().types.types,e=this._get_type(c.args[0]),(d[e]&&"undefined"!==typeof d[e][c.func]||d["default"]&&"undefined"!==typeof d["default"][c.func])&&!1===this._check(c.func,c.args[0]))return a.stopImmediatePropagation(),!1},this));J&&this.get_container().bind("load_node.jstree set_type.jstree",C.proxy(function(a,c){var d=c&&c.rslt&&c.rslt.obj&&-1!==c.rslt.obj?this._get_node(c.rslt.obj).parent():this.get_container_ul(),e=!1,f=this._get_settings().types;C.each(f.types,
function(a,b){if(b.icon&&(b.icon.image||b.icon.position))e="default"===a?d.find("li > a > .jstree-icon"):d.find("li["+f.type_attr+"='"+a+"'] > a > .jstree-icon"),b.icon.image&&e.css("backgroundImage","url("+b.icon.image+")"),e.css("backgroundPosition",b.icon.position||"0 0")})},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:!1,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(a,b){b.type&&this._get_settings().types.use_data&&
this.set_type(b.type,a)},_get_type:function(a){a=this._get_node(a);return!a||!a.length?!1:a.attr(this._get_settings().types.type_attr)||"default"},set_type:function(a,b){var b=this._get_node(b),c=!b.length||!a?!1:b.attr(this._get_settings().types.type_attr,a);c&&this.__callback({obj:b,type:a});return c},_check:function(a,b,c){var b=this._get_node(b),d=!1,e=this._get_type(b),f=0,j=this,i=this._get_settings().types,g=!1;if(-1===b)if(i[a])d=i[a];else return;else{if(!1===e)return;(g=i.use_data?b.data("jstree"):
!1)&&g.types&&"undefined"!==typeof g.types[a]?d=g.types[a]:i.types[e]&&"undefined"!==typeof i.types[e][a]?d=i.types[e][a]:i.types["default"]&&"undefined"!==typeof i.types["default"][a]&&(d=i.types["default"][a])}C.isFunction(d)&&(d=d.call(this,b));"max_depth"===a&&(-1!==b&&!1!==c&&-2!==i.max_depth&&0!==d)&&b.children("a:eq(0)").parentsUntil(".jstree","li").each(function(b){if(-1!==i.max_depth&&0>=i.max_depth-(b+1))return d=0,!1;f=0===b?d:j._check(a,this,!1);if(-1!==f&&0>=f-(b+1))return d=0,!1;if(0<=
f&&(f-(b+1)<d||0>d))d=f-(b+1);if(0<=i.max_depth&&(i.max_depth-(b+1)<d||0>d))d=i.max_depth-(b+1)});return d},check_move:function(){if(!this.__call_old())return!1;var a=this._get_move(),b=a.rt._get_settings().types,c=a.rt._check("max_children",a.cr),d=a.rt._check("max_depth",a.cr),e=a.rt._check("valid_children",a.cr),f=0,j=1;if("none"===e||C.isArray(e)&&(a.ot&&a.ot._get_type)&&(a.o.each(function(){if(-1===C.inArray(a.ot._get_type(this),e))return j=!1}),!1===j)||-2!==b.max_children&&-1!==c&&(f=-1===
a.cr?this.get_container().find("> ul > li").not(a.o).length:a.cr.find("> ul > li").not(a.o).length,f+a.o.length>c))return!1;if(-2!==b.max_depth&&-1!==d){j=0;if(0===d)return!1;if("undefined"===typeof a.o.d){for(b=a.o;0<b.length;)b=b.find("> ul > li"),j++;a.o.d=j}if(0>d-a.o.d)return!1}return!0},create_node:function(a,b,c,d,e,f){if(!f&&(e||this._is_loaded(a))){var j="string"==typeof b&&b.match(/^before|after$/i)&&-1!==a?this._get_parent(a):this._get_node(a),i=this._get_settings().types,g=this._check("max_children",
j),h=this._check("max_depth",j),l=this._check("valid_children",j);"string"===typeof c&&(c={data:c});c||(c={});if("none"===l)return!1;if(C.isArray(l))if(!c.attr||!c.attr[i.type_attr])c.attr||(c.attr={}),c.attr[i.type_attr]=l[0];else if(-1===C.inArray(c.attr[i.type_attr],l))return!1;if(-2!==i.max_children&&-1!==g&&(j=-1===j?this.get_container().find("> ul > li").length:j.find("> ul > li").length,j+1>g)||-2!==i.max_depth&&-1!==h&&0>h-1)return!1}return this.__call_old(!0,a,b,c,d,e,f)}}});var D=jQuery;
D.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(!0);this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return 3==this.nodeType}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(a,b,c){var d=this;this.load_node_html(a,function(){d.__callback({obj:d._get_node(a)});b.call(this)},c)},_is_loaded:function(a){a=this._get_node(a);return-1==a||!a||
!this._get_settings().html_data.ajax&&!D.isFunction(this._get_settings().html_data.data)||a.is(".jstree-open, .jstree-leaf")||0<a.children("ul").children("li").size()},load_node_html:function(a,b,c){var d,e=this.get_settings().html_data,f=function(){};d=function(){};if((a=this._get_node(a))&&-1!==a){if(a.data("jstree_is_loading"))return;a.data("jstree_is_loading",!0)}switch(!0){case D.isFunction(e.data):e.data.call(this,a,D.proxy(function(c){c&&""!==c&&c.toString&&""!==c.toString().replace(/^[\s\n]+$/,
"")?(c=D(c),c.is("ul")||(c=D("<ul />").append(c)),-1==a||!a?this.get_container().children("ul").empty().append(c.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"):(a.children("a.jstree-loading").removeClass("jstree-loading"),a.append(c).children("ul").find("li, a").filter(function(){return!this.firstChild||
!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),a.removeData("jstree_is_loading")),this.clean_node(a),b&&b.call(this)):a&&-1!==a?(a.children("a.jstree-loading").removeClass("jstree-loading"),a.removeData("jstree_is_loading"),e.correct_state&&(this.correct_state(a),b&&b.call(this))):e.correct_state&&(this.get_container().children("ul").empty(),b&&b.call(this))},
this));break;case !e.data&&!e.ajax:if(!a||-1==a)this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();b&&b.call(this);break;case !!e.data&&!e.ajax||!!e.data&&!!e.ajax&&(!a||-1===a):if(!a||
-1==a)d=D(e.data),d.is("ul")||(d=D("<ul />").append(d)),this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();b&&b.call(this);break;case !e.data&&!!e.ajax||!!e.data&&!!e.ajax&&a&&-1!==a:a=this._get_node(a),f=function(b,
d,f){var g=this.get_settings().html_data.ajax.error;g&&g.call(this,b,d,f);-1!=a&&a.length?(a.children("a.jstree-loading").removeClass("jstree-loading"),a.removeData("jstree_is_loading"),"success"===d&&e.correct_state&&this.correct_state(a)):"success"===d&&e.correct_state&&this.get_container().children("ul").empty();c&&c.call(this)},d=function(c,d,g){var h=this.get_settings().html_data.ajax.success;h&&(c=h.call(this,c,d,g)||c);if(""===c||c&&c.toString&&""===c.toString().replace(/^[\s\n]+$/,""))return f.call(this,
g,d,"");c?(c=D(c),c.is("ul")||(c=D("<ul />").append(c)),-1==a||!a?this.get_container().children("ul").empty().append(c.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"):(a.children("a.jstree-loading").removeClass("jstree-loading"),a.append(c).children("ul").find("li, a").filter(function(){return!this.firstChild||
!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),a.removeData("jstree_is_loading")),this.clean_node(a),b&&b.call(this)):a&&-1!==a?(a.children("a.jstree-loading").removeClass("jstree-loading"),a.removeData("jstree_is_loading"),e.correct_state&&(this.correct_state(a),b&&b.call(this))):e.correct_state&&(this.get_container().children("ul").empty(),b&&b.call(this))},
e.ajax.context=this,e.ajax.error=f,e.ajax.success=d,e.ajax.dataType||(e.ajax.dataType="html"),D.isFunction(e.ajax.url)&&(e.ajax.url=e.ajax.url.call(this,a)),D.isFunction(e.ajax.data)&&(e.ajax.data=e.ajax.data.call(this,a)),D.ajax(e.ajax)}}}});D.jstree.defaults.plugins.push("html_data");var w=jQuery;w.jstree.plugin("themeroller",{__init:function(){var a=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",
function(b){w(b.currentTarget).hasClass("jstree-loading")||w(this).addClass(a.item_h)}).delegate("a","mouseleave.jstree",function(){w(this).removeClass(a.item_h)}).bind("init.jstree",w.proxy(function(a,c){c.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh");this._themeroller(c.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",w.proxy(function(a,c){this._themeroller(c.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",
w.proxy(function(){this._themeroller()},this)).bind("close_node.jstree",w.proxy(function(a,c){this._themeroller(c.rslt.obj)},this)).bind("delete_node.jstree",w.proxy(function(a,c){this._themeroller(c.rslt.parent)},this)).bind("correct_state.jstree",w.proxy(function(b,c){c.rslt.obj.children("ins.jstree-icon").removeClass(a.opened+" "+a.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return-1===this.className.toString().replace(a.item_clsd,"").replace(a.item_open,"").replace(a.item_leaf,
"").indexOf("ui-icon-")}).removeClass(a.item_open+" "+a.item_clsd).addClass(a.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",w.proxy(function(b,c){c.rslt.obj.children("a").addClass(a.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",w.proxy(function(){this.get_container().find("a."+a.item_a).removeClass(a.item_a).end().find("a.jstree-clicked").addClass(a.item_a)},this)).bind("dehover_node.jstree",w.proxy(function(b,c){c.rslt.obj.children("a").removeClass(a.item_h)},this)).bind("hover_node.jstree",
w.proxy(function(b,c){this.get_container().find("a."+a.item_h).not(c.rslt.obj).removeClass(a.item_h);c.rslt.obj.children("a").addClass(a.item_h)},this)).bind("move_node.jstree",w.proxy(function(a,c){this._themeroller(c.rslt.o);this._themeroller(c.rslt.op)},this))},__destroy:function(){var a=this._get_settings().themeroller,b=["ui-icon"];w.each(a,function(a,d){d=d.split(" ");d.length&&(b=b.concat(d))});this.get_container().removeClass("ui-widget-content").find("."+b.join(", .")).removeClass(b.join(" "))},
_fn:{_themeroller:function(a){var b=this._get_settings().themeroller,a=!a||-1==a?this.get_container_ul():this._get_node(a).parent();a.find("li.jstree-closed").children("ins.jstree-icon").removeClass(b.opened).addClass("ui-icon "+b.closed).end().children("a").addClass(b.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(b.item_clsd,"").replace(b.item_open,"").replace(b.item_leaf,"").indexOf("ui-icon-")}).removeClass(b.item_leaf+" "+
b.item_open).addClass(b.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(b.closed).addClass("ui-icon "+b.opened).end().children("a").addClass(b.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(b.item_clsd,"").replace(b.item_open,"").replace(b.item_leaf,"").indexOf("ui-icon-")}).removeClass(b.item_leaf+" "+b.item_clsd).addClass(b.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(b.closed+
" ui-icon "+b.opened).end().children("a").addClass(b.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(b.item_clsd,"").replace(b.item_open,"").replace(b.item_leaf,"").indexOf("ui-icon-")}).removeClass(b.item_clsd+" "+b.item_open).addClass(b.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",
item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}});w(function(){w.vakata.css.add_sheet({str:".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }",title:"jstree"})});var Q=jQuery;Q.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",Q.proxy(function(a,b){var c=[],d=!0,e;"move_node"==b.func&&(!0===b.args[4]&&b.args[0].o&&b.args[0].o.length)&&(b.args[0].o.children("a").each(function(){c.push(Q(this).text().replace(/^\s+/g,
""))}),d=this._check_unique(c,b.args[0].np.find("> ul > li").not(b.args[0].o),"move_node"));if("create_node"==b.func&&(b.args[4]||this._is_loaded(b.args[0]))){d=this._get_node(b.args[0]);if(b.args[1]&&("before"===b.args[1]||"after"===b.args[1]))if(d=this._get_parent(b.args[0]),!d||-1===d)d=this.get_container();"string"===typeof b.args[2]?c.push(b.args[2]):!b.args[2]||!b.args[2].data?c.push(this._get_string("new_node")):c.push(b.args[2].data);d=this._check_unique(c,d.find("> ul > li"),"create_node")}if("rename_node"==
b.func){c.push(b.args[1]);e=this._get_node(b.args[0]);d=this._get_parent(e);if(!d||-1===d)d=this.get_container();d=this._check_unique(c,d.find("> ul > li").not(e),"rename_node")}if(!d)return a.stopPropagation(),!1},this))},defaults:{error_callback:Q.noop},_fn:{_check_unique:function(a,b,c){var d=[];b.children("a").each(function(){d.push(Q(this).text().replace(/^\s+/g,""))});if(!d.length||!a.length)return!0;d=d.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,
"").split(",");return d.length+a.length!=d.concat(a).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length?(this._get_settings().unique.error_callback.call(null,a,b,c),!1):!0},check_move:function(){if(!this.__call_old())return!1;var a=this._get_move(),b=[];return a.o&&a.o.length?(a.o.children("a").each(function(){b.push(Q(this).text().replace(/^\s+/g,""))}),this._check_unique(b,a.np.find("> ul > li").not(a.o),"check_move")):!0}}});var x=
jQuery;x.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui)throw"jsTree wholerow: jsTree UI plugin not included.";this.data.wholerow.html=!1;this.data.wholerow.to=!1;this.get_container().bind("init.jstree",x.proxy(function(){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",x.proxy(function(a,b){this._prepare_wholerow_span(b&&b.rslt&&b.rslt.obj?b.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",
x.proxy(function(a,b){this.data.to&&clearTimeout(this.data.to);var c=this,d=b&&b.rslt&&b.rslt.obj?b.rslt.obj:-1;this.data.to=setTimeout(function(){c._prepare_wholerow_ul(d)},0)},this)).bind("deselect_all.jstree",x.proxy(function(){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",x.proxy(function(a,b){b.rslt.obj.each(function(){b.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+
parseInt((x(this).offset().top-b.inst.get_container().offset().top+b.inst.get_container()[0].scrollTop)/b.inst.data.core.li_height,10)+")").children("a").attr("class",b.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",x.proxy(function(a,b){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));"hover_node"===a.type&&this.get_container().find(" > .jstree-wholerow li:visible:eq("+
parseInt((b.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height,10)+")").children("a").attr("class",b.rslt.obj.children(".jstree-hovered").attr("class"))},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(a){var b=x(a.currentTarget);"A"===a.target.tagName||"INS"===a.target.tagName&&b.closest("li").is(".jstree-open, .jstree-closed")||(b.closest("li").children("a:visible:eq(0)").click(),a.stopImmediatePropagation())}).delegate("li",
"mouseover.jstree",x.proxy(function(a){a.stopImmediatePropagation();if(x(a.currentTarget).children(".jstree-hovered, .jstree-clicked").length)return!1;this.hover_node(a.currentTarget);return!1},this)).delegate("li","mouseleave.jstree",x.proxy(function(a){x(a.currentTarget).children("a").hasClass("jstree-hovered").length||this.dehover_node(a.currentTarget)},this));(S||J)&&x.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove();
this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(a){a=!a||-1==a?this.get_container().find("> ul > li"):this._get_node(a);!1!==a&&a.each(function(){x(this).find("li").andSelf().each(function(){var a=x(this);if(a.children(".jstree-wholerow-span").length)return!0;a.prepend("<span class='jstree-wholerow-span' style='width:"+18*a.parentsUntil(".jstree","li").length+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var a=this.get_container().children("ul").eq(0),
b=a.html();a.addClass("jstree-wholerow-real");this.data.wholerow.last_html!==b&&(this.data.wholerow.last_html=b,this.get_container().children(".jstree-wholerow").remove(),this.get_container().append(a.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(a.parent()[0].scrollWidth).css("top",-1*(a.height()+(S?5:0))).find("li[id]").each(function(){this.removeAttribute("id")}).end()))}}});x(function(){var a=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";
W&&(a+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } ");if(S||J)a+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ";x.vakata.css.add_sheet({str:a,title:"jstree"})});var H=jQuery,aa=
["getChildren","getChildrenCount","getAttr","getName","getProps"];H.jstree.plugin("model",{__init:function(){if(!this.data.json_data)throw"jsTree model: jsTree json_data plugin not included.";this._get_settings().json_data.data=function(a,b){var c=-1==a?this._get_settings().model.object:a.data("jstree_model"),d=c,e=aa,f=!0,d=d||{},e=[].concat(e);H.each(e,function(a,b){if(!H.isFunction(d[b]))return f=!1});if(!f)return b.call(null,!1);this._get_settings().model.async?c.getChildren(H.proxy(function(a){this.model_done(a,
b)},this)):this.model_done(c.getChildren(),b)}},defaults:{object:!1,id_prefix:!1,async:!1},_fn:{model_done:function(a,b){var c=[],d=this._get_settings(),e=this;H.isArray(a)||(a=[a]);H.each(a,function(a,b){var g=b.getProps()||{};g.attr=b.getAttr()||{};b.getChildrenCount()&&(g.state="closed");g.data=b.getName();H.isArray(g.data)||(g.data=[g.data]);e.data.types&&H.isFunction(b.getType)&&(g.attr[d.types.type_attr]=b.getType());g.attr.id&&d.model.id_prefix&&(g.attr.id=d.model.id_prefix+g.attr.id);g.metadata||
(g.metadata={});g.metadata.jstree_model=b;c.push(g)});b.call(null,c)}}})}})();